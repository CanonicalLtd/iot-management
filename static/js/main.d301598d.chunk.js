(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{22:function(e,t,a){e.exports=a(57)},49:function(e,t,a){},57:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(18),l=a.n(r),c=a(1),i=a(2),o=a(4),u=a(3),d=a(5),m=a(9),h={Standard:100,Admin:200,Superuser:300},p={1:"waiting",2:"enrolled",3:"disabled"},v={"account-name-desc":"Name of the company","account-code-desc":"Account ID from the Ubuntu Store",accounts:"Accounts",active:"Active",address:"Address",brand:"Brand","brand-desc":"Brand ID from the model assertion",cancel:"Cancel",close:"Close",code:"Code","confirm-snap-install":"Enter the snap to install","confirm-user-delete":"Confirm user deletion","copy-device-key":"Copy device public key to clipboard",created:"Created","current-time":"Current Time","delete-user":"Delete User",description:"Description","device-detail":"Device Details","device-name-desc":"Unique name of the device",devices:"Devices","devices-connected":"Connected Devices",disabled:"Disabled","edit-account":"Edit Account","edit-device":"Edit Device Registration","edit-user":"Edit User",email:"Email",enrolled:"Enrolled","error-auth-device":"Invalid device","error-no-auth":"You do not have permissions to access this site. Please login.","error-no-permissions":"You do not have permissions to access this page","error-account-invalid":"Invalid Account","error-user-invalid":"Invalid User","firmware-version":"Firmware Version",groups:"Groups","hardware-version":"Hardware Version",id:"ID",identity:"Identity",info:"Info","install-on-device":"Install on device","install-snap":"Install a snap","installed-snaps":"Installed Snaps","kernel-version":"Kernel Version",key:"Key","last-update":"Last Update",loading:"Loading...",model:"Model","model-desc":"Model name from the model assertion",modified:"Modified",name:"Name","new-account":"Create New Account","new-device":"New Device Registration","new-user":"Create New User","no-accounts":"No accounts registered","no-devices":"No devices registered","no-groups":"No groups registered","no-users":"No users registered",ok:"OK","on-classic":"On Classic","os-version":"OS Version",refresh:"Refresh","refresh-snap-list":"Update installed snaps","reg-date":"Registration Date",register:"Register","register-desc":"Devices must be registered with the Identity Service to allow them to connect securely to the cloud services","register-devices":"Registered Devices",registered:"Registered",remove:"Remove",role:"Role",save:"Save","search-store":"search store for snap",serial:"Serial Number","serial-desc":"Serial Number from the serial assertion",series:"Series",settings:"Settings","serial-number":"Serial Number","site-description":"Manage Ubuntu devices connected via the MQTT protocol.",snap:"Snap","snap-store":"Snap Store",snaps:"Snaps","software-version":"Software Version",status:"Status",summary:"Summary","system-info":"System Information","utc-offset":"UTC Offset",timezone:"Timezone",title:"Device Management Service","toggle-status":"Enable/Disable",update:"Update",uptime:"Uptime","user-email-desc":"Email address of the user","user-not-found":"You do not have permissions to access this site","user-name-desc":"Full name of the user","user-username-desc":"Ubuntu SSO name of the user",username:"Username",users:"Users",version:"Version","view-settings":"View configuration",waiting:"Waiting",yes:"Yes"},g=a(19),f=a.n(g),E=a(6),b=a.n(E),k="/v1/";var N={baseUrl:window.location.protocol+"//"+window.location.hostname+":"+window.location.port+k},y={version:function(e,t){return b.a.get(N.baseUrl+"version")},getToken:function(){return b.a.get(N.baseUrl+"token")},getAuthToken:function(){return b.a.get(N.baseUrl+"authtoken")},accountsList:function(e,t){return b.a.get(N.baseUrl+"organizations")},accountsNew:function(e,t){return b.a.post(N.baseUrl+"organizations",e)},accountsGet:function(e,t){return b.a.get(N.baseUrl+"organizations/"+e)},accountsUpdate:function(e,t,a){return b.a.put(N.baseUrl+"organizations/"+e,t)},accountsForUsers:function(e,t){return b.a.get(N.baseUrl+"users/"+e+"/organizations")},accountsUpdateForUser:function(e,t,a){return b.a.post(N.baseUrl+"users/"+e+"/organizations/"+t)},groupsList:function(e,t){return b.a.get(N.baseUrl+e+"/groups")},snapsList:function(e,t,a){return b.a.get(N.baseUrl+"device/"+e+"/"+t+"/snaps")},snapsInstallRefresh:function(e,t,a){return b.a.post(N.baseUrl+"snaps/"+e+"/"+t.device.deviceId+"/list")},snapsRemove:function(e,t,a,n){return b.a.delete(N.baseUrl+"snaps/"+e+"/"+t.device.deviceId+"/"+a)},snapsInstall:function(e,t,a,n){return b.a.post(N.baseUrl+"snaps/"+e+"/"+t.device.deviceId+"/"+a)},snapsUpdate:function(e,t,a,n,s){return b.a.put(N.baseUrl+"snaps/"+e+"/"+t.device.deviceId+"/"+a+"/"+n)},snapsSettings:function(e,t,a,n){return b.a.get(N.baseUrl+"snaps/"+e+"/"+t.device.deviceId+"/"+a+"/settings")},snapsSettingsUpdate:function(e,t,a,n,s){return b.a.put(N.baseUrl+"snaps/"+e+"/"+t.device.deviceId+"/"+a+"/settings",n)},storeSearch:function(e,t){return b.a.get(N.baseUrl+"store/snaps/"+e)},clientsList:function(e,t,a){return b.a.get(N.baseUrl+e+"/register/devices")},clientsGet:function(e,t,a){return b.a.get(N.baseUrl+e+"/register/devices/"+t)},clientsNew:function(e,t,a){return b.a.post(N.baseUrl+e+"/register/devices",t)},clientsDeviceObject:function(e,t,a){return b.a.get(N.baseUrl+e+"/clients/"+t+"/device")},clientsUpdate:function(e,t,a,n){return b.a.put(N.baseUrl+e+"/register/devices/"+t,{status:a})},devicesUpdate:function(e,t,a){return b.a.put(N.baseUrl+t.accountCode+"/devices/"+t.id,t)},devicesList:function(e,t){return b.a.get(N.baseUrl+e+"/devices")},devicesGet:function(e,t,a){return b.a.get(N.baseUrl+e+"/devices/"+t)},usersList:function(e,t){return b.a.get(N.baseUrl+"users")},usersNew:function(e,t){return b.a.post(N.baseUrl+"users",e)},usersGet:function(e,t){return b.a.get(N.baseUrl+"users/"+e)},usersUpdate:function(e,t,a){return b.a.put(N.baseUrl+"users/"+e,t)},usersDelete:function(e,t){return b.a.delete(N.baseUrl+"users/"+e)}},S={register:["register","devices"],devices:["info","snaps"]};function w(e){return v[e]||e}function C(){var e=window.location.pathname.split("/");switch(e.length){case 2:return{section:e[1]};case 3:return{section:e[1],sectionId:e[2]};case 4:return{section:e[1],sectionId:e[2],subsection:e[3]};default:return{}}}function O(e){return function(e){return I(h.Standard,e)}(e)}function j(e){return I(h.Admin,e)}function U(e){return I(h.Superuser,e)}function A(e){var t;switch(e){case h.Standard:t="Standard";break;case h.Admin:t="Admin";break;case h.Superuser:t="Superuser";break;default:t="invalid role"}return t}function I(e,t){return!!t&&(!!t.role&&t.role>=e)}function D(e){var t=w(e.code);return e.message&&(t+=": "+e.message),t}function _(e){sessionStorage.setItem("accountCode",e.orgid),sessionStorage.setItem("accountName",e.name)}function R(){return{orgid:sessionStorage.getItem("accountCode"),name:sessionStorage.getItem("accountName")}}var T=["devices","groups"],F=["devices","groups","accounts"],x=["devices","groups","accounts","users"],L=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"link",value:function(e){return this.props.sectionId?"/"+this.props.section+"/"+this.props.sectionId+"/"+e:"/"+e}},{key:"render",value:function(){var e,t=this,a=this.props.token;if(this.props.links)e=this.props.links;else switch(a.role){case h.Admin:e=F;break;case h.Superuser:e=x;break;case h.Standard:e=T;break;default:e=[]}return s.a.createElement("ul",{className:"p-navigation__links",role:"menu"},e.map(function(e){var a="";return t.props.section!==e&&t.props.subsection!==e||(a=" active"),s.a.createElement("li",{key:e,className:"p-navigation__link"+a,role:"menuitem"},s.a.createElement("a",{href:t.link(e)},w(e)))}))}}]),t}(n.Component),z=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).handleAccountChange=function(e){e.preventDefault();var t=e.target.value,n=a.props.accounts.filter(function(e){return e.orgid===t})[0];a.props.onAccountChange(n)},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"renderAccounts",value:function(e){var t=this;return O(e)?0===this.props.accounts.length?s.a.createElement("span",null):s.a.createElement("li",{className:"p-navigation__link"},s.a.createElement("form",{id:"account-form"},s.a.createElement("select",{value:this.props.selectedAccount.orgid,onChange:this.handleAccountChange},this.props.accounts.map(function(e){return s.a.createElement("option",{key:e.orgid,value:e.orgid,selected:e.orgid===t.props.selectedAccount.orgid},e.name)})))):s.a.createElement("span",null)}},{key:"renderUser",value:function(e){return O(e)?e.name?s.a.createElement("li",{className:"p-navigation__link"},s.a.createElement("a",{href:"https://login.ubuntu.com/",className:"p-link--external"},e.name)):void 0:s.a.createElement("li",{className:"p-navigation__link"},s.a.createElement("a",{href:"/login",className:"p-link--external"},w("login")))}},{key:"renderUserLogout",value:function(e){if(O(e))return s.a.createElement("li",{className:"p-navigation__link"},s.a.createElement("a",{href:"/logout"},w("logout")))}},{key:"render",value:function(){var e=this.props.token;return s.a.createElement("ul",{className:"p-navigation__links u-float-right"},this.renderAccounts(e),this.renderUser(e),this.renderUserLogout(e))}}]),t}(n.Component),M=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement("header",{className:"p-navigation p-navigation--dark",role:"banner"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"p-navigation__banner"},s.a.createElement("div",{className:"p-navigation__logo"},s.a.createElement("div",{className:"nav_logo"},s.a.createElement("a",{className:"p-navigation__link",href:"/"},s.a.createElement("img",{className:"p-navigation__image",src:"https://assets.ubuntu.com/v1/eb4e0ae3-iotdevice.svg",alt:"IoT Management Service"}),"\xa0",s.a.createElement("h3",null,"IoT Management")))),s.a.createElement("a",{href:"#navigation",className:"p-navigation__toggle--open",title:"menu",onClick:this.handleToggleMenu},s.a.createElement("img",{src:"/static/images/navigation-menu-plain.svg",width:"30px",alt:"menu"})),s.a.createElement("nav",{className:"p-navigation__nav"},s.a.createElement("span",{className:"u-off-screen"},s.a.createElement("a",{href:"#navigation"},"Jump to site")),s.a.createElement(L,{section:this.props.section,token:this.props.token}),s.a.createElement(z,{token:this.props.token,accounts:this.props.accounts,selectedAccount:this.props.selectedAccount,onAccountChange:this.props.onAccountChange})))))}}]),t}(n.Component),P=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={version:""},a.getVersion(),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getVersion",value:function(){var e=this;y.version().then(function(t){e.setState({version:t.data.version})})}},{key:"render",value:function(){return s.a.createElement("footer",{className:"spacer"},s.a.createElement("div",null,s.a.createElement("p",null,s.a.createElement("small",null,w("version"),": ",this.state.version))))}}]),t}(n.Component),G=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){if(this.props.message){var e="p-notification--";return this.props.type?e+=this.props.type:e+="negative",s.a.createElement("div",{className:e},s.a.createElement("p",{className:"p-notification__response"},this.props.message))}return s.a.createElement("span",null)}}]),t}(n.Component),K=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={message:null,accounts:[]},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"renderTable",value:function(e){return e.length>0?s.a.createElement("div",null,s.a.createElement("table",null,s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,w("code")),s.a.createElement("th",null,w("name")))),s.a.createElement("tbody",null,this.renderRows(e)))):s.a.createElement("p",null,w("no-accounts"))}},{key:"renderRows",value:function(e){var t=this;return e.map(function(e){var a=U(t.props.token);return s.a.createElement("tr",{key:e.id},s.a.createElement("td",null,a?s.a.createElement("a",{href:"/accounts/"+e.orgid},e.orgid):e.orgid),s.a.createElement("td",null,e.name))})}},{key:"render",value:function(){if(!j(this.props.token))return s.a.createElement("div",{className:"row"},s.a.createElement(G,{message:w("error-no-permissions")}));var e=U(this.props.token);return s.a.createElement("div",{className:"row"},s.a.createElement("section",{className:"row"},s.a.createElement("div",null,s.a.createElement("h2",null,w("accounts"),e?s.a.createElement("div",{className:"u-float-right"},s.a.createElement("a",{href:"/accounts/new",className:"p-button--brand",title:w("new-account")},s.a.createElement("i",{className:"fa fa-plus","aria-hidden":"true"}))):"")),s.a.createElement("div",{className:"col-12"},s.a.createElement(G,{message:this.state.message}))),s.a.createElement("section",{className:"row"},this.renderTable(this.props.accounts)))}}]),t}(n.Component),V=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleChangeCode=function(e){var t=a.state.account;t.orgid=e.target.value,a.setState({account:t})},a.handleChangeName=function(e){var t=a.state.account;t.name=e.target.value,a.setState({account:t})},a.handleChangeActive=function(e){var t=a.state.account;t.active=e.target.checked,a.setState({account:t})},a.handleSaveClick=function(e){e.preventDefault(),a.props.id?y.accountsUpdate(a.props.id,a.state.account).then(function(e){window.location="/accounts"}).catch(function(e){a.setState({error:D(e.response.data),hideForm:!1})}):y.accountsNew(a.state.account).then(function(e){window.location="/accounts"}).catch(function(e){a.setState({error:D(e.response.data),hideForm:!1})})},a.state={title:null,error:null,hideForm:!1,account:{active:!0}},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.id?(this.setTitle("edit-account"),this.getAccount(this.props.id)):this.setTitle("new-account")}},{key:"getAccount",value:function(e){var t=this;y.accountsGet(e).then(function(e){t.setState({account:e.data.organization})}).catch(function(e){t.setState({error:D(e.response.data),hideForm:!0})})}},{key:"setTitle",value:function(e){this.setState({title:w(e)})}},{key:"render",value:function(){return U(this.props.token)?this.state.hideForm?s.a.createElement("div",{className:"row"},s.a.createElement(G,{message:this.state.error})):this.props.id&&!this.state.account.orgid?s.a.createElement("div",null):s.a.createElement("div",{className:"row"},s.a.createElement("section",{className:"row"},s.a.createElement("h2",null,this.state.title),s.a.createElement(G,{message:this.state.error}),s.a.createElement("form",null,s.a.createElement("fieldset",null,s.a.createElement("label",{htmlFor:"code"},w("code"),":",s.a.createElement("input",{type:"text",id:"code",placeholder:w("account-code-desc"),value:this.state.account.orgid,onChange:this.handleChangeCode})),s.a.createElement("label",{htmlFor:"name"},w("name"),":",s.a.createElement("input",{type:"text",id:"name",placeholder:w("account-name-desc"),value:this.state.account.name,onChange:this.handleChangeName})))),s.a.createElement("div",null,s.a.createElement("a",{href:"/accounts",className:"p-button--neutral"},w("cancel")),"\xa0",s.a.createElement("a",{href:"/accounts",onClick:this.handleSaveClick,className:"p-button--brand"},w("save")))),s.a.createElement("br",null)):s.a.createElement("div",{className:"row"},s.a.createElement(G,{message:w("error-no-permissions")}))}}]),t}(n.Component),q=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.props.message?s.a.createElement("div",{className:"p-card warning"},s.a.createElement("p",null,this.props.message),s.a.createElement("div",null,s.a.createElement("button",{onClick:this.props.handleCancelClick,className:"p-button--neutral small"},w("cancel")),s.a.createElement("button",{onClick:this.props.handleYesClick,className:"p-button--brand small"},w("ok")))):s.a.createElement("span",null)}}]),t}(n.Component),Y=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleDelete=function(e){e.preventDefault(),a.setState({confirmDelete:e.target.getAttribute("data-key")})},a.handleDeleteUser=function(e){e.preventDefault();var t=a.state.users.filter(function(e){return e.username===a.state.confirmDelete});0!==t.length&&y.usersDelete(t[0].username).then(function(e){window.location="/users"}).catch(function(e){a.setState({error:D(e.response.data)})})},a.handleDeleteUserCancel=function(e){e.preventDefault(),a.setState({confirmDelete:null})},a.handleClickAccount=function(e){e.preventDefault();var t=e.target.getAttribute("data-account"),n=parseInt(e.target.getAttribute("data-user"),10),s=e.target.getAttribute("data-username");y.accountsUpdateForUser(s,t).then(function(e){a.getAccountsForUser(s,n)})},a.showAccounts=function(e){e.preventDefault();var t=parseInt(e.target.getAttribute("data-key"),10),n=e.target.getAttribute("data-user");a.state.showAccountsId===t?a.setState({showAccountsId:null}):a.getAccountsForUser(n,t)},a.state={message:null,users:[],accounts:[],confirmDelete:null,showAccountsId:null},a.getUsers(),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getUsers",value:function(){var e=this;y.usersList().then(function(t){e.setState({users:t.data.users})})}},{key:"getAccountsForUser",value:function(e,t){var a=this;y.accountsForUsers(e).then(function(e){a.setState({accounts:e.data.organizations,showAccountsId:t})})}},{key:"renderTable",value:function(e){return e.length>0?s.a.createElement("div",null,s.a.createElement("table",null,s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null),s.a.createElement("th",null,w("username")),s.a.createElement("th",null,w("name")),s.a.createElement("th",null,w("email")),s.a.createElement("th",null,w("role")),s.a.createElement("th",null,w("accounts")))),this.renderRows(e))):s.a.createElement("p",null,w("no-users"))}},{key:"renderActions",value:function(e){return e.username!==this.state.confirmDelete?s.a.createElement("div",null,s.a.createElement("a",{href:"/users/".concat(e.username),className:"p-button--brand small",title:w("edit-user")},s.a.createElement("i",{className:"fa fa-edit"})),"\xa0",s.a.createElement("button",{onClick:this.handleDelete,"data-key":e.username,className:"p-button--neutral small",title:w("delete-user")},s.a.createElement("i",{className:"fa fa-trash","data-key":e.username}))):s.a.createElement(q,{message:w("confirm-user-delete"),handleYesClick:this.handleDeleteUser,handleCancelClick:this.handleDeleteUserCancel})}},{key:"renderRows",value:function(e){var t=this;return e.map(function(e){var a="";return e.id===t.state.showAccountsId&&(a="borderless"),s.a.createElement("tbody",null,s.a.createElement("tr",{key:e.id,className:a},s.a.createElement("td",null,t.renderActions(e)),s.a.createElement("td",{className:"overflow",title:e.username},e.username),s.a.createElement("td",{className:"overflow",title:e.name},e.name),s.a.createElement("td",{className:"overflow",title:e.email},e.email),s.a.createElement("td",{className:"overflow",title:A(e.role)},A(e.role)),s.a.createElement("td",{className:"overflow"},s.a.createElement("button",{className:"p-button--neutral small",title:w("view-accounts"),"data-key":e.id,"data-user":e.username,onClick:t.showAccounts},s.a.createElement("i",{className:"fa fa-building","aria-hidden":"true","data-key":e.id,"data-user":e.username})))),t.renderAccounts(e))})}},{key:"renderAccounts",value:function(e){var t=this;if(e.id===this.state.showAccountsId){var a,n=this.state.accounts.map(function(n){return a=n.selected?"p-button--brand":"p-button--neutral",s.a.createElement("button",{key:n.orgid,"data-account":n.orgid,"data-user":e.id,"data-username":e.username,onClick:t.handleClickAccount,className:a},n.name)});return s.a.createElement("tr",null,s.a.createElement("td",{colSpan:"6"},"Select accounts for ",e.name,":",s.a.createElement("br",null)," ",n))}}},{key:"render",value:function(){return j(this.props.token)?s.a.createElement("div",{className:"row"},s.a.createElement("section",{className:"row"},s.a.createElement("div",null,s.a.createElement("h2",null,w("users"),s.a.createElement("div",{className:"u-float-right"},s.a.createElement("a",{href:"/users/new",className:"p-button--brand",title:w("new-user")},s.a.createElement("i",{className:"fa fa-plus","aria-hidden":"true"}))))),s.a.createElement("div",{className:"col-12"},s.a.createElement(G,{message:this.state.message}))),s.a.createElement("section",{className:"row"},this.renderTable(this.state.users))):s.a.createElement("div",{className:"row"},s.a.createElement(G,{message:w("error-no-permissions")}))}}]),t}(n.Component),B=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleChangeUsername=function(e){var t=a.state.user;t.username=e.target.value,a.setState({user:t})},a.handleChangeName=function(e){var t=a.state.user;t.name=e.target.value,a.setState({user:t})},a.handleChangeEmail=function(e){var t=a.state.user;t.email=e.target.value,a.setState({user:t})},a.handleChangeRole=function(e){var t=a.state.user;t.role=parseInt(e.target.value,10),a.setState({user:t})},a.handleSaveClick=function(e){e.preventDefault(),a.props.username?y.usersUpdate(a.props.username,a.state.user).then(function(e){window.location="/users"}).catch(function(e){a.setState({error:D(e.response.data),hideForm:!1})}):y.usersNew(a.state.user).then(function(e){window.location="/users"}).catch(function(e){a.setState({error:D(e.response.data),hideForm:!1})})},a.state={title:null,user:{},error:null,hideForm:!1},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.username?(this.setTitle("edit-user"),this.getUser(this.props.username)):this.setTitle("new-user")}},{key:"setTitle",value:function(e){this.setState({title:w(e)})}},{key:"getUser",value:function(e){var t=this;y.usersGet(e).then(function(e){t.setState({user:e.data.user,hideForm:!1})}).catch(function(e){t.setState({error:D(e.response.data)})})}},{key:"renderError",value:function(){if(this.state.error)return s.a.createElement(G,{message:this.state.error})}},{key:"render",value:function(){return U(this.props.token)?this.state.hideForm?s.a.createElement("div",{className:"row"},s.a.createElement(G,{message:this.state.error})):s.a.createElement("div",{className:"row"},s.a.createElement("section",{className:"row"},s.a.createElement("h2",null,this.state.title),s.a.createElement(G,{message:this.state.error}),s.a.createElement("form",null,s.a.createElement("fieldset",null,s.a.createElement("label",{htmlFor:"username"},w("username"),":",s.a.createElement("input",{type:"text",id:"username",placeholder:w("user-username-desc"),value:this.state.user.username,onChange:this.handleChangeUsername})),s.a.createElement("label",{htmlFor:"name"},w("name"),":",s.a.createElement("input",{type:"text",id:"name",placeholder:w("user-name-desc"),value:this.state.user.name,onChange:this.handleChangeName})),s.a.createElement("label",{htmlFor:"email"},w("email"),":",s.a.createElement("input",{type:"text",id:"email",placeholder:w("user-email-desc"),value:this.state.user.email,onChange:this.handleChangeEmail})),s.a.createElement("label",{htmlFor:"role"},w("role"),":",s.a.createElement("select",{value:this.state.user.role,id:"role",onChange:this.handleChangeRole},s.a.createElement("option",null),s.a.createElement("option",{key:"standard",value:"100"},"Standard"),s.a.createElement("option",{key:"admin",value:"200"},"Admin"),s.a.createElement("option",{key:"superuser",value:"300"},"Superuser"))))),s.a.createElement("div",null,s.a.createElement("a",{href:"/users",className:"p-button--neutral"},w("cancel")),"\xa0",s.a.createElement("a",{href:"/users",onClick:this.handleSaveClick,className:"p-button--brand"},w("save")))),s.a.createElement("br",null)):s.a.createElement("div",{className:"row"},s.a.createElement(G,{message:w("error-no-permissions")}))}}]),t}(n.Component),J=a(8),W=a.n(J);function H(e){var t=e.cond,a=e.children;return t?Array.isArray(a)?s.a.createElement("div",null,a):a:null}var Q,X=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.client;return e.device?s.a.createElement("div",{className:"row"},s.a.createElement("h1",{className:"tight"},e.device.brand," ",e.device.model),s.a.createElement("h4",{className:"subtitle"},e.device.serial),s.a.createElement("section",{className:"row spacer"},s.a.createElement("div",{className:"col-12"},s.a.createElement(G,{message:this.props.message}))),s.a.createElement(H,{cond:!this.props.message},s.a.createElement("section",{className:"row spacer"},s.a.createElement("div",{className:"p-card--highlighted col-6"},s.a.createElement("table",{className:"p-card__content"},s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("td",null,w("last-update"),":"),s.a.createElement("td",null,W()(e.device.lastRefresh).format("llll"))),s.a.createElement("tr",null,s.a.createElement("td",null,w("registered"),":"),s.a.createElement("td",null,W()(e.device.created).format("llll"))))))),s.a.createElement("section",{className:"row spacer"},s.a.createElement("div",{className:"p-card"},s.a.createElement("h3",{className:"p-card__title"},w("system-info")),s.a.createElement("table",{className:"p-card__content"},s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("td",null,w("model"),":"),s.a.createElement("td",null,e.device.brand," ",e.device.model)),s.a.createElement("tr",null,s.a.createElement("td",null,w("serial-number"),":"),s.a.createElement("td",null,e.device.serial)),s.a.createElement("tr",null,s.a.createElement("td",null,w("os-version"),":"),s.a.createElement("td",null,e.device.version.osId," ",e.device.version.osVersionId)),s.a.createElement("tr",null,s.a.createElement("td",null,w("series"),":"),s.a.createElement("td",null,e.device.version.series)),s.a.createElement("tr",null,s.a.createElement("td",null,w("version"),":"),s.a.createElement("td",null,e.device.version.version)),s.a.createElement("tr",null,s.a.createElement("td",null,w("kernel-version"),":"),s.a.createElement("td",null,e.device.version.kernelVersion)),s.a.createElement("tr",null,s.a.createElement("td",null,w("on-classic"),":"),s.a.createElement("td",null,e.device.version.onClassic?"true":"false")))))))):s.a.createElement("div",null,"Loading...")}}]),t}(n.Component),Z=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getAge",value:function(e){var t=W()(e),a=W()(),n=W.a.duration(a.diff(t)).asMinutes();return n<2?s.a.createElement("i",{className:"fa fa-clock led-green",title:t.format("llll")}):n<5?s.a.createElement("i",{className:"fa fa-clock led-orange",title:t.format("llll")}):s.a.createElement("i",{className:"fa fa-clock led-red",title:t.format("llll")})}},{key:"renderTable",value:function(e){return e.length>0?s.a.createElement("div",null,s.a.createElement("table",null,s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,w("brand")),s.a.createElement("th",null,w("model")),s.a.createElement("th",null,w("serial")),s.a.createElement("th",null,w("reg-date")),s.a.createElement("th",null,w("last-update")))),s.a.createElement("tbody",null,this.renderRows(e)))):s.a.createElement("p",null,w("no-devices"))}},{key:"renderRows",value:function(e){var t=this;return e.map(function(e){return s.a.createElement("tr",{key:e.registrationId},s.a.createElement("td",{className:"overflow"},s.a.createElement("a",{href:"/devices/"+e.deviceId+"/info"},e.brand)),s.a.createElement("td",{className:"overflow"},s.a.createElement("a",{href:"/devices/"+e.deviceId+"/info"},e.model)),s.a.createElement("td",{className:"overflow"},s.a.createElement("a",{href:"/devices/"+e.deviceId+"/info"},e.serial)),s.a.createElement("td",{className:"overflow"},W()(e.created).format("lll")),s.a.createElement("td",null,W()(e.lastRefresh).format("lll"),"\xa0",t.getAge(e.lastRefresh)))})}},{key:"render",value:function(){return s.a.createElement("div",{className:"row"},s.a.createElement("section",{className:"row"},s.a.createElement("h2",null,w("devices-connected")),s.a.createElement("div",{className:"col-12"},s.a.createElement(G,{message:this.props.message}))),s.a.createElement("section",{className:"row spacer"},this.renderTable(this.props.devices)))}}]),t}(n.Component),$=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).copyToClipboard=function(e){e.preventDefault();var t=document.createElement("textarea");t.value=e.target.getAttribute("data-key"),document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)},a.state={message:null},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"getStatus",value:function(e){var t=w(p[e]);return 1===e?s.a.createElement("span",null,s.a.createElement("i",{className:"fa fa-clock led-orange",title:t}),"\xa0",t):2===e?s.a.createElement("span",null,s.a.createElement("i",{className:"fa fa-clipboard-check led-green",title:t}),"\xa0",t):s.a.createElement("span",null,s.a.createElement("i",{className:"fa fa-times-circle led-red",title:t}),"\xa0",t)}},{key:"renderTable",value:function(e){if(e)return e.length>0?s.a.createElement("div",null,s.a.createElement("table",null,s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",{className:"small"}),s.a.createElement("th",null,w("id")),s.a.createElement("th",null,w("brand")),s.a.createElement("th",null,w("model")),s.a.createElement("th",null,w("serial")),s.a.createElement("th",{className:"overflow"},w("device-key")),s.a.createElement("th",{className:"xsmall"},w("status")))),s.a.createElement("tbody",null,this.renderRows(e)))):s.a.createElement("p",null,w("no-devices"))}},{key:"renderRows",value:function(e){var t=this;return e.map(function(e){return s.a.createElement("tr",{key:e.id},s.a.createElement("td",null,s.a.createElement("a",{href:"/register/"+e.id,className:"p-button--neutral small"},s.a.createElement("i",{className:"fa fa-edit"})),e.device.deviceKey?s.a.createElement("a",{href:"",onClick:t.copyToClipboard,"data-key":e.device.deviceKey,className:"p-button--neutral small",title:w("copy-device-key")},s.a.createElement("i",{className:"fa fa-clipboard","data-key":e.device.deviceKey})):""),s.a.createElement("td",{className:"overflow"},e.id),s.a.createElement("td",{className:"overflow"},e.device.brand),s.a.createElement("td",{className:"overflow"},e.device.model),s.a.createElement("td",{className:"overflow"},e.device.serial),s.a.createElement("td",{className:"overflow",title:e.device.deviceKey},e.device.deviceKey&&e.device.deviceKey.substr(0,40)||""),s.a.createElement("td",null,t.getStatus(e.status)))})}},{key:"render",value:function(){return console.log("---",this.props.devices),s.a.createElement("div",{className:"row"},s.a.createElement("section",{className:"row"},s.a.createElement("h2",null,w("register-devices"),U(this.props.token)?s.a.createElement("div",{className:"u-float-right"},s.a.createElement("a",{href:"/register/new",className:"p-button--brand",title:w("new-device")},s.a.createElement("i",{className:"fa fa-plus","aria-hidden":"true"}))):""),s.a.createElement("div",{className:"col-12"},s.a.createElement(G,{message:this.state.message}))),s.a.createElement("section",{className:"row spacer"},this.renderTable(this.props.devices)))}}]),t}(n.Component),ee=[{id:1,name:"Waiting"},{id:2,name:"Enrolled"},{id:3,name:"Disabled"}],te=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleChangeBrand=function(e){var t=a.state.device;t.brand=e.target.value,a.setState({device:t})},a.handleChangeModel=function(e){var t=a.state.device;t.model=e.target.value,a.setState({device:t})},a.handleChangeSerial=function(e){var t=a.state.device;t.serial=e.target.value,a.setState({device:t})},a.handleChangeStatus=function(e){var t=parseInt(e.target.value,10);a.setState({statusTo:t})},a.handleSaveClick=function(e){e.preventDefault(),a.props.id?y.clientsUpdate(a.props.account.orgid,a.state.deviceId,a.state.statusTo).then(function(e){window.location="/register"}).catch(function(e){a.setState({error:D(e.response.data),hideForm:!1})}):y.clientsNew(a.props.account.orgid,a.state.device).then(function(e){window.location="/register"}).catch(function(e){a.setState({error:D(e.response.data),hideForm:!1})})},a.state={title:null,error:null,hideForm:!1,deviceId:"",status:0,statusTo:0,device:{orgid:a.props.account.orgid}},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.id?(this.setTitle("edit-device"),this.getDevice(this.props.id)):this.setTitle("new-device")}},{key:"getDevice",value:function(e){var t=this;y.clientsGet(this.props.account.orgid,e).then(function(e){t.setState({device:e.data.enrollment.device,status:e.data.enrollment.status,statusTo:e.data.enrollment.status,deviceId:e.data.enrollment.id})}).catch(function(e){t.setState({error:D(e.response.data),hideForm:!0})})}},{key:"setTitle",value:function(e){this.setState({title:w(e)})}},{key:"render",value:function(){var e=this;if(!j(this.props.token))return s.a.createElement("div",{className:"row"},s.a.createElement(G,{message:w("error-no-permissions")}));if(this.state.hideForm)return s.a.createElement("div",{className:"row"},s.a.createElement(G,{message:this.state.error}));var t=!!this.state.status;return s.a.createElement("div",{className:"row"},s.a.createElement("section",{className:"row"},s.a.createElement("h2",null,this.state.title),s.a.createElement("div",null,w("register-desc"),s.a.createElement("br",null)),s.a.createElement(G,{message:this.state.error}),s.a.createElement("form",null,s.a.createElement("fieldset",null,this.props.id?s.a.createElement("label",{htmlFor:"id"},w("id"),":",s.a.createElement("input",{type:"text",id:"id",value:this.state.deviceId,disabled:!0})):"",s.a.createElement("label",{htmlFor:"brand"},w("brand"),":",s.a.createElement("input",{type:"text",id:"brand",placeholder:w("brand-desc"),value:this.state.device.brand,onChange:this.handleChangeBrand,disabled:t})),s.a.createElement("label",{htmlFor:"model"},w("model"),":",s.a.createElement("input",{type:"text",id:"model",placeholder:w("model-desc"),value:this.state.device.model,onChange:this.handleChangeModel,disabled:t})),s.a.createElement("label",{htmlFor:"serial"},w("serial"),":",s.a.createElement("input",{type:"text",id:"serial",placeholder:w("serial-desc"),value:this.state.device.serial,onChange:this.handleChangeSerial,disabled:t})),s.a.createElement("label",null,this.state.status>0?s.a.createElement("select",{value:this.state.statusTo,onChange:this.handleChangeStatus},ee.map(function(t){return s.a.createElement("option",{key:t.id,value:t.id,selected:t.id===e.state.statusTo},t.name)})):""))),s.a.createElement("div",null,s.a.createElement("a",{href:"/register",className:"p-button--neutral"},w("cancel")),"\xa0",s.a.createElement("a",{href:"/register",onClick:this.handleSaveClick,className:"p-button--brand"},w("save")))),s.a.createElement("br",null))}}]),t}(n.Component),ae=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).pageUp=function(){var e=a.calculatePages(),t=a.state.page+1;t>e&&(t=e),a.setState({page:t}),a.signalPageChange(t)},a.pageDown=function(){var e=a.state.page-1;e<=0&&(e=1),a.setState({page:e}),a.signalPageChange(e)},a.state={page:1,query:null,maxRecords:5|e.pageSize},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"signalPageChange",value:function(e){var t=(e-1)*this.state.maxRecords;this.props.pageChange(t,t+this.state.maxRecords)}},{key:"calculatePages",value:function(){var e=this.props.displayRows.length,t=parseInt(e/this.state.maxRecords,10);return e%this.state.maxRecords>0&&(t+=1),t}},{key:"renderPaging",value:function(){var e=this.calculatePages();return e>1?s.a.createElement("div",{className:"u-float--right spacer"},s.a.createElement("button",{className:"p-button--neutral small",href:"",onClick:this.pageDown},"\xab"),s.a.createElement("span",null,"\xa0",this.state.page," of ",e,"\xa0"),s.a.createElement("button",{className:"p-button--neutral small",href:"",onClick:this.pageUp},"\xbb")):s.a.createElement("div",{className:"u-float--right"})}},{key:"render",value:function(){return s.a.createElement("div",{className:"col-12"},this.renderPaging())}}]),t}(n.Component),ne=a(20),se=a.n(ne),re=5,le=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleSearchChange=function(e){e.preventDefault(),a.setState({snapName:e.target.value})},a.handleKeyPress=function(e){"Enter"===e.key&&a.handleSearchStore(e)},a.handleSearchStore=function(e){e.preventDefault(),a.searchStore()},a.handleInstall=function(e){e.preventDefault();var t=e.target.getAttribute("data-key");a.props.handleInstallClick(t)},a.handleRecordsForPage=function(e,t){a.setState({startRow:e,endRow:t})},a.state={snapName:"",snaps:[],loadingSearch:!1,page:1,startRow:0,endRow:re},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"searchStore",value:function(){var e=this;0!==this.state.snapName.length&&(this.setState({loadingSearch:!0}),y.storeSearch(this.state.snapName).then(function(t){t.data._embedded&&t.data._embedded["clickindex:package"]&&e.setState({snaps:t.data._embedded["clickindex:package"],loadingSearch:!1,message:null,messageType:null})}))}},{key:"renderSnaps",value:function(e){var t=this;return e.length>0?s.a.createElement("div",null,s.a.createElement("p",null,e.length," snaps found"),s.a.createElement("table",null,s.a.createElement("tbody",null,e.slice(this.state.startRow,this.state.endRow).map(function(e){return s.a.createElement("tr",{key:e.snap_id,title:e.description},s.a.createElement("td",{className:"small"},s.a.createElement("button",{"data-key":e.package_name,className:"p-button--neutral small",title:w("install-on-device"),onClick:t.handleInstall},s.a.createElement("i",{"data-key":e.package_name,className:"fa fa-cloud-upload-alt","aria-hidden":"true"}))),s.a.createElement("td",{className:"overflow"},s.a.createElement("b",null,e.package_name)," ",e.version),s.a.createElement("td",{className:"overflow"},e.developer_name," (",se()(e.binary_filesize),")"))})))):s.a.createElement("div",null,"No snaps found.")}},{key:"render",value:function(){var e=this.state.snaps;return this.props.message?s.a.createElement("div",{className:"p-card col-4"},s.a.createElement("h3",{className:"p-card__title"},w("snap-store")),s.a.createElement("p",null,this.state.loadingSearch?s.a.createElement("img",{src:"/static/images/ajax-loader.gif",alt:w("loading")}):"",this.props.message),s.a.createElement("p",null,s.a.createElement("form",{className:"p-search-box"},s.a.createElement("input",{className:"p-search-box__input",type:"search",name:"snapname",onKeyPress:this.handleKeyPress,onChange:this.handleSearchChange,placeholder:w("search-store")}),s.a.createElement("button",{type:"reset",className:"p-search-box__reset",alt:"reset"},s.a.createElement("i",{className:"p-icon--close"})),s.a.createElement("button",{type:"submit",onClick:this.handleSearchStore,className:"p-search-box__button",alt:"search"},s.a.createElement("i",{className:"p-icon--search"})))),s.a.createElement(ae,{displayRows:e,pageSize:re,pageChange:this.handleRecordsForPage}),this.renderSnaps(e),s.a.createElement("div",null,s.a.createElement("button",{onClick:this.props.handleCancelClick,className:"p-button--brand"},w("close")))):s.a.createElement("span",null)}}]),t}(n.Component),ce=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleRefreshList=function(e){e.preventDefault(),y.snapsInstallRefresh(a.props.account.orgid,a.props.device).then(function(e){a.setState({message:"Sent request to list snaps",messageType:"information"})})},a.handleInstall=function(e){e.preventDefault(),a.setState({showInstall:!0})},a.handleSnapInstall=function(e){y.snapsInstall(a.props.account.orgid,a.props.device,e).then(function(t){a.setState({message:"Sent request to install snap: "+e,messageType:"information"})})},a.handleSnapOnChange=function(e){e.preventDefault(),a.setState({snapName:e.target.value})},a.handleRefresh=function(e){e.preventDefault();var t=e.target.getAttribute("data-key");y.snapsUpdate(a.props.account.orgid,a.props.device,t,"refresh").then(function(e){a.setState({message:"Sent request to refresh snap: "+t,messageType:"information"})})},a.handleToggle=function(e){e.preventDefault();var t=e.target.getAttribute("data-key"),n="enable";"active"===a.findSnap(t).status&&(n="disable"),y.snapsUpdate(a.props.account.orgid,a.props.device,t,n).then(function(e){a.setState({message:"Sent request to enable/disable snap: "+t,messageType:"information"})})},a.handleRemove=function(e){e.preventDefault();var t=e.target.getAttribute("data-key");y.snapsRemove(a.props.account.orgid,a.props.device,t).then(function(e){a.setState({message:"Sent request to remove snap: "+t,messageType:"information"})})},a.handleDialogCancel=function(e){e.preventDefault(),a.setState({showInstall:!1})},a.handleShowSettings=function(e){e.preventDefault();var t=e.target.getAttribute("data-key");if(a.state.snapSettings===t)a.setState({snapSettings:null,settings:{}});else{var n=a.findSnap(t);0===n.config.length&&(n.config="{}");var s=JSON.stringify(JSON.parse(n.config),null,2);a.setState({snapSettings:t,settings:s})}},a.handleSettingsChange=function(e){e.preventDefault(),a.setState({settings:e.target.value})},a.handleSettingsUpdate=function(e){e.preventDefault();var t=e.target.getAttribute("data-key");y.snapsSettingsUpdate(a.props.account.orgid,a.props.device,t,a.state.settings).then(function(e){a.setState({snapSettings:null,message:"Sent request to update snap: "+t,messageType:"information"})})},a.state={message:null,messageType:null,showInstall:!1,snapName:"",snapSettings:null,settings:{},hideForm:!1},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"findSnap",value:function(e){return this.props.snaps.filter(function(t){return t.name===e})[0]}},{key:"renderShowInstall",value:function(){if(this.state.showInstall)return s.a.createElement(le,{message:w("confirm-snap-install"),handleTextChange:this.handleSnapOnChange,handleInstallClick:this.handleSnapInstall,handleCancelClick:this.handleDialogCancel})}},{key:"renderSettings",value:function(e){if(e.name===this.state.snapSettings)return s.a.createElement("tr",null,s.a.createElement("td",{colSpan:"6"},s.a.createElement("form",null,s.a.createElement("fieldset",null,s.a.createElement("label",{htmlFor:this.state.snapSettings},"Settings for ",this.state.snapSettings,":",s.a.createElement("textarea",{className:"col-12",rows:"4",value:this.state.settings,"data-key":this.state.snapSettings,onChange:this.handleSettingsChange}))),s.a.createElement("button",{className:"p-button--brand",onClick:this.handleSettingsUpdate,"data-key":e.name},w("update")))))}},{key:"render",value:function(){var e=this,t="",a="";this.state.showInstall&&(t=" col-8",a="hide");var n=this.props.device;return n.device?s.a.createElement("div",{className:"row"},s.a.createElement("h1",{className:"tight"},n.device.orgid," ",n.device.model),s.a.createElement("h4",{className:"subtitle"},n.device.serial),s.a.createElement("section",{className:"row spacer"},s.a.createElement("div",{className:"col-12"},s.a.createElement(G,{message:this.state.message,type:this.state.messageType}))),s.a.createElement(H,{cond:!this.state.hideForm},s.a.createElement("section",{className:"row spacer"},s.a.createElement("div",{className:"p-card"+t},s.a.createElement("h3",{className:"p-card__title"},w("installed-snaps"),s.a.createElement("div",{className:"u-float-right"},s.a.createElement("button",{onClick:this.handleRefreshList,className:"p-button--brand",title:w("refresh-snap-list")},s.a.createElement("i",{className:"fa fa-sync","aria-hidden":"true"})),s.a.createElement("button",{onClick:this.handleInstall,className:"p-button--brand",title:w("install-snap")},s.a.createElement("i",{className:"fa fa-plus","aria-hidden":"true"})))),s.a.createElement("p",{title:w("last-update")},W()(n.device.lastRefresh).format("llll")),s.a.createElement("table",{className:"p-card__content"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",{className:a}),s.a.createElement("th",{className:"small"},w("snap")),s.a.createElement("th",{className:"small"},w("channel")),s.a.createElement("th",null,w("version")),s.a.createElement("th",{className:"xsmall"},w("status")),s.a.createElement("th",{className:"xsmall"},w("settings")))),this.props.snaps.map(function(t){var n="";return t.name===e.state.snapSettings&&(n="borderless"),s.a.createElement("tbody",null,s.a.createElement("tr",{key:t.name,className:n},s.a.createElement("td",{className:a},s.a.createElement("button",{onClick:e.handleRefresh,className:"small u-float",title:w("refresh"),"data-key":t.name},s.a.createElement("i",{className:"fa fa-sync","aria-hidden":"true","data-key":t.name})),s.a.createElement("button",{onClick:e.handleToggle,className:"small",title:w("toggle-status"),"data-key":t.name},s.a.createElement("i",{className:"fa fa-plug","aria-hidden":"true","data-key":t.name})),s.a.createElement("button",{onClick:e.handleRemove,className:"small",title:w("remove"),"data-key":t.name},s.a.createElement("i",{className:"fa fa-times","aria-hidden":"true","data-key":t.name}))),s.a.createElement("td",{title:t.description},t.name),s.a.createElement("td",null,t.channel),s.a.createElement("td",null,t.version),s.a.createElement("td",null,t.status),s.a.createElement("td",null,s.a.createElement("button",{className:"p-button--neutral small",title:w("view-settings"),"data-key":t.name,onClick:e.handleShowSettings},s.a.createElement("i",{className:"fa fa-sliders-h","aria-hidden":"true","data-key":t.name})))),e.renderSettings(t))}))),this.renderShowInstall()))):s.a.createElement("div",null,"Loading...")}}]),t}(n.Component),ie=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"renderRows",value:function(e){return e.map(function(e){return console.log(e),s.a.createElement("tr",{key:e.id},s.a.createElement("td",{className:"overflow"},s.a.createElement("button",null,e.name)))})}},{key:"renderTable",value:function(e){if(e)return e.length>0?s.a.createElement("div",{className:"col-3"},s.a.createElement("table",null,s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,w("name")))),s.a.createElement("tbody",null,this.renderRows(e)))):s.a.createElement("p",null,w("no-groups"))}},{key:"render",value:function(){return s.a.createElement("div",{className:"row"},s.a.createElement("section",{className:"row"},s.a.createElement("h2",null,w("groups")),s.a.createElement("div",{className:"col-12"},s.a.createElement(G,{message:this.props.message}))),s.a.createElement("section",{className:"row spacer"},this.renderTable(this.props.groups)))}}]),t}(n.Component),oe=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={token:e.token||{}},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"renderUser",value:function(){return O(this.props.token)?s.a.createElement("div",null):s.a.createElement("div",null,s.a.createElement("a",{href:"/login",className:"p-button--brand"},w("login")))}},{key:"renderError",value:function(){if(this.props.error)return s.a.createElement(G,{message:w("user-not-found")})}},{key:"render",value:function(){return s.a.createElement("div",{className:"row"},s.a.createElement("section",{className:"row"},s.a.createElement("h2",null,w("title")),s.a.createElement("h3",null,this.props.account.name),this.renderError(),s.a.createElement("div",null,s.a.createElement("div",{className:"p-card"},w("site-description")))),s.a.createElement("section",{className:"row spacer"},this.renderUser()))}}]),t}(n.Component),ue=(a(49),a(21)),de=a.n(ue)()(),me=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleAccountChange=function(e){_(e),a.setState({selectedAccount:e}),a.updateDataForRoute(e,!0)},a.state={location:de.location,token:e.token||{},accounts:[],selectedAccount:R()||{},reg_devices:[],devices:[],groups:[],clients:[],client:{},clientObject:{},snaps:[]},de.listen(a.handleNavigation.bind(Object(m.a)(Object(m.a)(a)))),a.getAccounts(),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"handleNavigation",value:function(e){this.setState({location:e}),window.scrollTo(0,0)}},{key:"getAccounts",value:function(){var e=this;O(this.props.token)&&y.accountsList().then(function(t){var a=e.state.selectedAccount;R().orgid&&"undefined"!==R().orgid||t.data.organizations.length>0&&_(a=t.data.organizations[0]),e.setState({accounts:t.data.organizations,selectedAccount:a}),e.updateDataForRoute(a,!1)})}},{key:"getRegisteredDevices",value:function(e){var t=this;y.clientsList(e).then(function(e){t.setState({reg_devices:e.data.devices})})}},{key:"getDevices",value:function(e){var t=this;y.devicesList(e).then(function(e){t.setState({devices:e.data.devices})})}},{key:"getClient",value:function(e,t){var a=this;y.clientsDetail(e,t).then(function(e){a.setState({client:e.data})}).catch(function(e){a.setState({message:D(e.response.data),client:{}})})}},{key:"getGroups",value:function(e){var t=this;y.groupsList(e).then(function(e){t.setState({groups:e.data.groups})}).catch(function(e){t.setState({message:D(e.response.data),clients:[]})})}},{key:"getSnaps",value:function(e,t){var a=this;y.snapsList(e,t).then(function(e){a.setState({snaps:e.data.snaps})}).catch(function(e){a.setState({message:D(e.response),snaps:[]})})}},{key:"updateDataForRoute",value:function(e,t){var a=C();t&&"clients"===a.section&&a.sectionId?window.location="/clients":("register"===a.section&&this.getRegisteredDevices(e.orgid),"devices"===a.section&&this.getDevices(e.orgid),"devices"===a.section&&a.sectionId&&this.getClient(e.orgid,a.sectionId),"devices"===a.section&&a.sectionId&&"snaps"===a.subsection&&this.getSnaps(e.orgid,a.sectionId),"groups"===a.section&&this.getGroups(e.orgid))}},{key:"renderAccounts",value:function(e,t){if(!e)return s.a.createElement(K,{token:this.props.token,accounts:this.state.accounts});switch(e){case"new":return s.a.createElement(V,{token:this.props.token});default:return s.a.createElement(V,{token:this.props.token,id:e})}}},{key:"renderUsers",value:function(e,t){if(!e)return s.a.createElement(Y,{token:this.props.token});switch(e){case"new":return s.a.createElement(B,{token:this.props.token});default:return s.a.createElement(B,{token:this.props.token,username:e})}}},{key:"renderDevices",value:function(e,t){if(!e)return s.a.createElement(Z,{token:this.props.token,devices:this.state.devices,account:this.state.selectedAccount});switch(t){case"snaps":return s.a.createElement(ce,{token:this.props.token,endpoint:e,account:this.state.selectedAccount,device:this.state.client,snaps:this.state.snaps});default:return s.a.createElement(X,{token:this.props.token,endpoint:e,message:this.state.message,client:this.state.client,clientObject:this.state.clientObject,account:this.state.selectedAccount})}}},{key:"renderRegister",value:function(e,t){if(!e)return s.a.createElement($,{token:this.props.token,devices:this.state.reg_devices,account:this.state.selectedAccount});switch(e){case"new":return s.a.createElement(te,{token:this.props.token,account:this.state.selectedAccount});default:return s.a.createElement(te,{token:this.props.token,account:this.state.selectedAccount,id:e})}}},{key:"renderGroups",value:function(e,t){if(!e)return s.a.createElement(ie,{token:this.props.token,groups:this.state.groups,account:this.state.selectedAccount})}},{key:"renderSubnav",value:function(e,t,a){var n=function(e,t){if(""!==e)return"devices"!==e||t?S[e]:S.register}(e,t);return n?s.a.createElement("div",{className:"subnav"},s.a.createElement("nav",{className:"p-navigation__nav p-navigation--light",role:"menubar"},s.a.createElement(L,{links:n,section:e,sectionId:t,subsection:a,token:this.props.token}))):s.a.createElement("span",null)}},{key:"render",value:function(){var e=C();return console.log(e),console.log("---account",this.state.selectedAccount),s.a.createElement("div",{className:"App"},s.a.createElement(M,{token:this.props.token,section:e.section,accounts:this.state.accounts,selectedAccount:this.state.selectedAccount,onAccountChange:this.handleAccountChange}),s.a.createElement("section",{className:"p-strip--image is-shallow snapcraft-banner-background"},s.a.createElement("div",{className:"row"})),s.a.createElement(H,{cond:O(this.props.token)},this.renderSubnav(e.section,e.sectionId,e.subsection)),s.a.createElement(H,{cond:O(this.props.token)},s.a.createElement("div",{className:"page-content"},""===e.section?s.a.createElement(oe,{token:this.props.token,account:this.state.selectedAccount}):"","notfound"===e.section?s.a.createElement(oe,{token:this.props.token,error:!0}):"","devices"===e.section?this.renderDevices(e.sectionId,e.subsection):"","register"===e.section?this.renderRegister(e.sectionId,e.subsection):"","groups"===e.section?this.renderGroups(e.sectionId,e.subsection):"","accounts"===e.section?this.renderAccounts(e.sectionId,e.subsection):"","users"===e.section?this.renderUsers(e.sectionId,e.subsection):"")),s.a.createElement(H,{cond:!O(this.props.token)},s.a.createElement("div",{className:"page-content"},s.a.createElement("div",{className:"row"},s.a.createElement(G,{message:w("error-no-auth")}),s.a.createElement("a",{href:"/login",className:"p-button--brand"},w("login"))))),s.a.createElement(P,null))}}]),t}(n.Component);Q=function(e){l.a.render(s.a.createElement(me,{token:e}),document.getElementById("root"))},y.getAuthToken().then(function(e){var t=e.headers.authorization;if(t){var a=f()(t);console.log("---token:",a),Q(a||{})}else Q({})})}},[[22,1,2]]]);
//# sourceMappingURL=main.d301598d.chunk.js.map