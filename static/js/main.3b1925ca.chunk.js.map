{"version":3,"sources":["components/Constants.js","components/Messages.js","models/constants.js","models/api.js","components/Utils.js","components/Navigation.js","components/NavigationUser.js","components/Header.js","components/Footer.js","components/AlertBox.js","components/Accounts.js","components/AccountEdit.js","components/DialogBox.js","components/Users.js","components/UserEdit.js","components/If.js","components/Device.js","components/Register.js","components/RegisterEdit.js","components/Pagination.js","components/SnapDialogBox.js","components/DeviceSnaps.js","components/Groups.js","components/Index.js","App.js","index.js"],"names":["Role","Standard","Admin","Superuser","Messages","account-name-desc","account-code-desc","accounts","active","address","cancel","close","code","confirm-snap-install","confirm-user-delete","created","current-time","description","device-detail","device-name-desc","devices","edit-account","edit-device","edit-user","email","error-auth-device","error-no-auth","error-no-permissions","error-account-invalid","error-user-invalid","firmware-version","groups","hardware-version","identity","info","install-on-device","install-snap","installed-snaps","key","last-update","loading","model","modified","name","new-account","new-device","new-user","no-accounts","no-devices","no-groups","no-users","ok","refresh","reg-date","register","register-desc","register-devices","registered","remove","role","save","search-store","settings","serial-number","site-description","snap","snap-store","snaps","software-version","status","summary","system-info","utc-offset","timezone","title","toggle-status","update","uptime","user-email-desc","user-not-found","user-name-desc","user-username-desc","username","users","version","view-settings","yes","API_PREFIX","Constants","baseUrl","window","location","protocol","hostname","port","service","query","cancelCallback","axios","get","constants","getToken","getAuthToken","accountsList","accountsNew","post","accountsGet","id","accountsUpdate","put","accountsForUsers","accountsUpdateForUser","userId","accountId","groupsList","account","snapsList","snapsRemove","device","delete","accountCode","serial","snapsInstall","snapsUpdate","snapsSettings","snapsSettingsUpdate","storeSearch","snapName","clientsList","clientsDetail","clientsDeviceObject","devicesList","devicesGet","devicesNew","devicesUpdate","usersList","usersNew","usersGet","usersUpdate","subLinks","T","message","parseRoute","parts","pathname","split","length","section","sectionId","subsection","isLoggedIn","token","isUser","isUserStandard","isUserAdmin","isUserSuperuser","roleAsString","str","formatError","data","error_code","saveAccount","sessionStorage","setItem","getAccount","parseInt","getItem","linksStandard","linksAdmin","linksSuperuser","Navigation","l","this","props","links","_this","react_default","a","createElement","className","map","href","link","Component","NavigationUser","handleAccountChange","e","preventDefault","target","value","filter","onAccountChange","_this2","accountFilter","selectedAccount","onChange","selected","renderAccounts","renderUser","renderUserLogout","Header","src","alt","onClick","handleToggleMenu","width","components_Navigation","components_NavigationUser","Footer","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","getVersion","api","then","response","setState","AlertBox","c","type","Accounts","getAccounts","items","renderRows","_this3","isSuperuser","components_AlertBox","aria-hidden","renderTable","AccountEdit","handleChangeCode","handleChangeName","handleChangeActive","checked","handleSaveClick","catch","error","hideForm","setTitle","htmlFor","placeholder","DialogBox","handleCancelClick","handleYesClick","Users","handleDelete","confirmDelete","getAttribute","handleDeleteUser","user","deleteUser","handleDeleteUserCancel","handleClickAccount","getAccountsForUser","showAccounts","showAccountsId","getUsers","concat","data-key","components_DialogBox","_this4","renderActions","data-user","item","_this5","style","acc","data-account","data-username","colSpan","UserEdit","handleChangeUsername","handleChangeEmail","handleChangeRole","getUser","If","_ref","cond","children","Array","isArray","callback","Device","d","client","moment","lastRefresh","format","softwareversion","firmwareversion","currenttime","utcoffset","Register","m","start","end","duration","diff","asMinutes","registrationId","getAge","RegisterEdit","getDevice","Pagination","pageUp","pages","calculatePages","page","signalPageChange","pageDown","maxRecords","pageSize","startRow","pageChange","displayRows","renderPaging","PAGELENGTH","SnapDialogBox","handleSearchChange","handleKeyPress","handleSearchStore","searchStore","handleInstall","handleInstallClick","handleRecordsForPage","endRow","loadingSearch","_embedded","messageType","slice","s","snap_id","package_name","developer_name","filesize","binary_filesize","onKeyPress","components_Pagination","renderSnaps","DeviceSnaps","handleRefreshList","reload","showInstall","handleSnapInstall","handleSnapOnChange","handleRefresh","handleToggle","action","findSnap","handleRemove","handleDialogCancel","handleShowSettings","snapSettings","JSON","stringify","parse","config","handleSettingsChange","handleSettingsUpdate","components_SnapDialogBox","handleTextChange","rows","tableWidth","hide","renderSettings","renderShowInstall","Groups","console","log","Index","renderError","history","createHistory","App","updateDataForRoute","clients","clientObject","listen","handleNavigation","bind","assertThisInitialized","scrollTo","endpoint","_this6","accountChanged","r","getDevices","getClient","getSnaps","getGroups","components_Accounts","components_AccountEdit","components_Users","components_UserEdit","components_Register","components_DeviceSnaps","components_Device","components_RegisterEdit","components_Groups","currentSection","sectionNavLinks","components_Header","renderSubnav","components_Index","renderDevices","renderRegister","renderGroups","renderUsers","components_Footer","ReactDOM","render","src_App","document","getElementById","resp","jwt","headers","authorization","jwtDecode"],"mappings":"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","file":"static/js/main.3b1925ca.chunk.js","sourcesContent":["/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nexport const Role = {\n    Standard: 100,\n    Admin: 200,\n    Superuser: 300,\n}\n\nexport const LoadingImage = '/static/images/ajax-loader.gif'\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nexport default {    \n    'account-name-desc':        'Name of the company',\n    'account-code-desc':        'Account ID from the Ubuntu Store',\n    'accounts':                 'Accounts',\n    'active':                   'Active',\n    'address':                  'Address',\n    'cancel':                   'Cancel',\n    'close':                    'Close',\n    'code':                     'Code',\n    'confirm-snap-install':     'Enter the snap to install',\n    'confirm-user-delete':      'Confirm user deletion',\n    'created':                  'Created',\n    'current-time':             'Current Time',\n    'description':              'Description',\n    'device-detail':            'Device Details',\n    'device-name-desc':         'Unique name of the device',\n    'devices':                  'Devices',\n    'edit-account':             'Edit Account',\n    'edit-device':              'Edit Device Registration',\n    'edit-user':                'Edit User',\n    'email':                    'Email',\n    'error-auth-device':        'Invalid device',\n    'error-no-auth':            'You do not have permissions to access this site. Please login.',\n    'error-no-permissions':     'You do not have permissions to access this page',\n    'error-account-invalid':    'Invalid Account',\n    'error-user-invalid':       'Invalid User',\n    'firmware-version':         'Firmware Version',\n    'groups':                   'Groups',\n    'hardware-version':         'Hardware Version',\n    'identity':                 'Identity',\n    'info':                     'Info',\n    'install-on-device':        'Install on device',\n    'install-snap':             'Install a snap',\n    'installed-snaps':          'Installed Snaps',\n    'key':                      'Key',\n    'last-update':              'Last Update',\n    'loading':                  'Loading...',\n    'model':                    'Model',\n    'modified':                 'Modified',\n    'name':                     'Name',\n    'new-account':              'Create New Account',\n    'new-device':               'New Device Registration',\n    'new-user':                 'Create New User',\n    'no-accounts':              'No accounts registered',\n    'no-devices':               'No devices registered',\n    'no-groups':                'No groups registered',\n    'no-users':                 'No users registered',\n    'ok':                       'OK',\n    'refresh':                  'Refresh',\n    'reg-date':                 'Registration Date',\n    'register':                 'Register',\n    'register-desc':            'Devices must be registered with the account to allow them to connect securely to the MQTT web',\n    'register-devices':         'Registered Devices',\n    'registered':               'Registered',\n    'remove':                   'Remove',\n    'role':                     'Role',\n    'save':                     'Save',\n    'search-store':             'search store for snap',\n    'settings':                 'Settings',\n    'serial-number':            'Serial Number',\n    'site-description':         'Manage Ubuntu devices connected via the MQTT protocol.',\n    'snap':                     'Snap',\n    'snap-store':               'Snap Store',\n    'snaps':                    'Snaps',\n    'software-version':         'Software Version',\n    'status':                   'Status',\n    'summary':                  'Summary',\n    'system-info':              'System Information',\n    'utc-offset':               'UTC Offset',\n    'timezone':                 'Timezone',\n    'title':                    'Device Management Service',\n    'toggle-status':            'Enable/Disable',\n    'update':                   'Update',\n    'uptime':                   'Uptime',\n    'user-email-desc':          'Email address of the user',\n    'user-not-found':           'You do not have permissions to access this site',\n    'user-name-desc':           'Full name of the user',\n    'user-username-desc':       'Ubuntu SSO name of the user',\n    'username':                 'Username',\n    'users':                    'Users',\n    'version':                  'Version',\n    'view-settings':            'View configuration',\n    'yes':                      'Yes',\n}\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nconst API_PREFIX = '/v1/'\n\nfunction getBaseURL() {\n    return window.location.protocol + '//' + window.location.hostname + ':' + window.location.port + API_PREFIX;\n}\n\nvar Constants = {\n    baseUrl: getBaseURL()\n}\n\nexport default Constants\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport axios from 'axios'\nimport constants from './constants'\n\nvar service = {\n\n    version: (query, cancelCallback) => {\n        return axios.get(constants.baseUrl + 'version');\n    },\n\n    getToken: () => {\n        return axios.get(constants.baseUrl + 'token')\n    },\n\n    getAuthToken: () => {\n        return axios.get(constants.baseUrl + 'authtoken')\n    },\n\n    accountsList: (query, cancelCallback) => {\n        return axios.get(constants.baseUrl + 'accounts');\n    },\n\n    accountsNew: (query, cancelCallback) => {\n        return axios.post(constants.baseUrl + 'accounts', query);\n    },\n\n    accountsGet: (id, cancelCallback) => {\n        return axios.get(constants.baseUrl + 'accounts/' + id);\n    },\n\n    accountsUpdate: (id, query, cancelCallback) => {\n        return axios.put(constants.baseUrl + 'accounts/' + id, query);\n    },\n\n    accountsForUsers: (username, cancelCallback) => {\n        return axios.get(constants.baseUrl + 'users/' + username + '/accounts');\n    },\n\n    accountsUpdateForUser: (userId, accountId, cancelCallback) => {\n        return axios.post(constants.baseUrl + 'users/' + userId + '/accounts/' + accountId);\n    },\n\n    groupsList: (account, cancelCallback) => {\n        return axios.get(constants.baseUrl + account + '/groups');\n    },\n\n    snapsList: (account, query, cancelCallback) => {\n        return axios.get(constants.baseUrl + account + '/' + query + '/snaps');\n    },\n\n    snapsRemove: (account,device, snap, cancelCallback) => {\n        return axios.delete(constants.baseUrl + 'snaps/' + device.device.accountCode + '/' + device.device.name + '/' + device.device.serial + '/' + snap);\n    },\n\n    snapsInstall: (account, device, snap, cancelCallback) => {\n        return axios.post(constants.baseUrl + 'snaps/' + device.device.accountCode + '/' + device.device.name + '/' + device.device.serial + '/' + snap);\n    },\n\n    snapsUpdate: (account, device, snap, query, cancelCallback) => {\n        return axios.put(constants.baseUrl + 'snaps/' + device.device.accountCode + '/' + device.device.name + '/' + device.device.serial + '/' + snap, query);\n    },\n\n    snapsSettings: (account, device, snap, cancelCallback) => {\n        return axios.get(constants.baseUrl + 'snaps/' + device.device.accountCode + '/' + device.device.name + '/' + device.device.serial + '/' + snap + '/settings');\n    },\n\n    snapsSettingsUpdate: (account, device, snap, settings, cancelCallback) => {\n        return axios.put(constants.baseUrl + 'snaps/' + device.device.accountCode + '/'  + device.device.name + '/' + device.device.serial + '/' + snap + '/settings', settings);\n    },\n\n    storeSearch: (snapName,cancelCallback) => {\n        return axios.get(constants.baseUrl + 'store/snaps/' + snapName);\n    },\n\n    clientsList: (account, query, cancelCallback) => {\n        return axios.get(constants.baseUrl + account + '/clients');\n    },\n\n    clientsDetail: (account, query, cancelCallback) => {\n        return axios.get(constants.baseUrl + account + '/clients/' + query);\n    },\n\n    clientsDeviceObject: (account, query, cancelCallback) => {\n        return axios.get(constants.baseUrl + account + '/clients/' + query + '/device');\n    },\n\n    devicesList: (account, cancelCallback) => {\n        return axios.get(constants.baseUrl + account + '/devices');\n    },\n\n    devicesGet: (account, id, cancelCallback) => {\n        return axios.get(constants.baseUrl + account + '/devices/' + id);\n    },\n\n    devicesNew: (account, device, cancelCallback) => {\n        return axios.post(constants.baseUrl + account + '/devices', device);\n    },\n\n    devicesUpdate: (account, device, cancelCallback) => {\n        return axios.put(constants.baseUrl + device.accountCode + '/devices/' + device.id, device);\n    },\n\n    usersList: (query, cancelCallback) => {\n        return axios.get(constants.baseUrl + 'users');\n    },\n\n    usersNew: (query, cancelCallback) => {\n        return axios.post(constants.baseUrl + 'users', query);\n    },\n\n    usersGet: (id, cancelCallback) => {\n        return axios.get(constants.baseUrl + 'users/' + id);\n    },\n\n    usersUpdate: (id, query, cancelCallback) => {\n        return axios.put(constants.baseUrl + 'users/' + id, query);\n    }\n}\n\nexport default service\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport Messages from './Messages'\nimport {Role} from './Constants'\nimport jwtDecode from 'jwt-decode'\nimport api from '../models/api';\n\n\n\nconst subLinks = {\n    devices: ['info', 'snaps']\n}\n\nexport function T(message) {\n    const msg = Messages[message] || message;\n    return msg\n}\n\n// URL is in the form:\n//  /section\n//  /section/sectionId\n//  /section/sectionId/subsection\nexport function parseRoute() {\n    const parts = window.location.pathname.split('/')\n\n    switch (parts.length) {\n        case 2:\n            return {section: parts[1]}\n        case 3:\n            return {section: parts[1], sectionId: parts[2]}\n        case 4:\n            return {section: parts[1], sectionId: parts[2], subsection: parts[3]}\n        default:\n            return {}\n    }\n}\n\nexport function sectionNavLinks(section, sectionId) {\n    if (section === '') {\n        return;\n    }\n    if ((section === 'devices') && (!sectionId)) {\n        return;\n    }\n    return subLinks[section];\n}\n\nexport function isLoggedIn(token) {\n    return isUserStandard(token)\n}\n\nexport function isUserStandard(token) {\n    return isUser(Role.Standard, token)\n}\n\nexport function isUserAdmin(token) {\n    return isUser(Role.Admin, token)\n}\n\nexport function isUserSuperuser(token) {\n    return isUser(Role.Superuser, token)\n}\n\nexport function roleAsString(role) {\n    var str\n    switch (role) {\n        case Role.Standard:\n            str = \"Standard\"\t\n            break;\n        case Role.Admin:\n            str = \"Admin\"\n            break;\n        case Role.Superuser:\n            str = \"Superuser\"\n            break\n        default:\n            str= \"invalid role\"\n            break;\n    }\n    return str\n}\n\nfunction isUser(role, token) {\n    if (!token) return false\n    if (!token.role) return false\n\n    return (token.role >= role)\n}\n\nexport function getAuthToken(callback) {\n    // Get a fresh token and return it to the callback\n    // The token will be passed to the views\n    api.getAuthToken().then((resp) => {\n\n        var jwt = resp.headers.authorization\n\n        if (!jwt) {\n            callback({})\n            return\n        }\n        var token = jwtDecode(jwt)\n        console.log('---token:', token)\n\n        if (!token) {\n            callback({})\n            return\n        }\n        callback(token)\n    })\n}\n\nexport function formatError(data) {\n    var message = T(data.error_code);\n    if (data.message) {\n        message += ': ' + data.message;\n    }\n    return message;\n}\n\nexport function saveAccount(account) {\n    sessionStorage.setItem('accountId', account.id);\n    sessionStorage.setItem('accountCode', account.code);\n    sessionStorage.setItem('accountName', account.name);\n    sessionStorage.setItem('accountActive', account.active);\n}\n\nexport function getAccount() {\n    return {\n        id: parseInt(sessionStorage.getItem('accountId'),10),\n        code: sessionStorage.getItem('accountCode'),\n        name: sessionStorage.getItem('accountName'),\n        active: sessionStorage.getItem('accountActive')==='true',\n    }\n}\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport React, {Component} from 'react';\nimport {Role} from './Constants'\nimport {T} from './Utils';\n\nconst linksStandard  = ['devices', 'groups'];\nconst linksAdmin     = ['devices', 'groups', 'accounts'];\nconst linksSuperuser = ['devices', 'groups', 'accounts', 'users'];\n\nclass Navigation extends Component {\n\n    link(l) {\n        if (this.props.sectionId) {\n            // This is the secondary menu\n            return '/' + this.props.section + '/' + this.props.sectionId + '/' + l;\n        } else {\n            return '/' + l;\n        }\n    }\n\n    render() {\n\n        var token = this.props.token\n        var links;\n\n        if (this.props.links) {\n            links = this.props.links;\n        } else {\n            switch(token.role) {\n                case Role.Admin:\n                    links = linksAdmin;\n                    break;\n                case Role.Superuser:\n                    links = linksSuperuser;\n                    break;\n                case Role.Standard:\n                    links = linksStandard\n                    break\n                default:\n                    links = []\n            }\n        }\n\n        return (\n          <ul className=\"p-navigation__links\" role=\"menu\">\n              {links.map((l) => {\n                  var active = '';\n                  if ((this.props.section === l) || (this.props.subsection === l)) {\n                      active = ' active'\n                  }\n                  return (\n                    <li key={l} className={'p-navigation__link' + active} role=\"menuitem\"><a href={this.link(l)}>{T(l)}</a></li>\n                  )\n              })}\n          </ul>\n        );\n    }\n}\n\nexport default Navigation;\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport React, {Component} from 'react';\nimport {T, isLoggedIn} from './Utils'\n\n\nclass NavigationUser extends Component {\n\n    handleAccountChange = (e) => {\n        e.preventDefault()\n\n        // Get the account\n        var accountId = parseInt(e.target.value, 10);\n        var account = this.props.accounts.filter(a => {\n            return a.id === accountId\n        })[0]\n\n        this.props.onAccountChange(account)\n    }\n\n    renderAccounts(token) {\n        if (!isLoggedIn(token)) {\n            return <span />\n        }\n\n        if (!token.accountFilter) {\n            return <span />\n        }\n\n        if (this.props.accounts.length === 0) {\n            return <span />\n        }\n\n        return (\n            <li className=\"p-navigation__link\">\n                <form id=\"account-form\">\n                    <select value={this.props.selectedAccount.id} onChange={this.handleAccountChange}>\n                        {this.props.accounts.map(a => {\n                            return <option key={a.id} value={a.id} selected={a.id===this.props.selectedAccount.id}>{a.name}</option>;\n                        })}\n                    </select>\n                </form>\n            </li>\n        )\n\n    }\n\n    renderUser(token) {\n        if (isLoggedIn(token)) {\n            // The name is undefined if user authentication is off\n            if (token.name) {\n                return (\n                    <li className=\"p-navigation__link\"><a href=\"https://login.ubuntu.com/\" className=\"p-link--external\">{token.name}</a></li>\n                )\n            }\n        } else {\n            return (\n            <li className=\"p-navigation__link\"><a href=\"/login\" className=\"p-link--external\">{T('login')}</a></li>\n            )\n        }\n    }\n\n    renderUserLogout(token) {\n        if (isLoggedIn(token)) {\n            return (\n                <li className=\"p-navigation__link\"><a href=\"/logout\">{T('logout')}</a></li>\n            )\n        }\n    }\n\n    render() {\n\n        var token = this.props.token\n\n        return (\n          <ul className=\"p-navigation__links u-float-right\">\n              {this.renderAccounts(token)}\n              {this.renderUser(token)}\n              {this.renderUserLogout(token)}\n          </ul>\n        );\n    }\n}\n\nexport default NavigationUser;\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport React, {Component} from 'react';\nimport Navigation from './Navigation';\nimport NavigationUser from './NavigationUser';\nimport {T} from './Utils';\n\nclass Header extends Component {\n\n    render() {\n        return (\n            <header className=\"p-navigation p-navigation--dark\" role=\"banner\">\n                <div className=\"row\">\n                  <div className=\"p-navigation__banner\">\n                    <div className=\"p-navigation__logo\">\n                            <div className=\"nav_logo\">\n                                <a className=\"p-navigation__link\" href=\"/\">\n                                    <img className=\"p-navigation__image\" src=\"https://assets.ubuntu.com/v1/eb4e0ae3-iotdevice.svg\" alt=\"IoT Management Service\" />\n                                    &nbsp;\n                                    <h3>IoT Management</h3>\n                                </a>\n                            </div>\n\n                    </div>\n                    <a href=\"#navigation\" className=\"p-navigation__toggle--open\" title=\"menu\" onClick={this.handleToggleMenu}>\n                        <img src=\"/static/images/navigation-menu-plain.svg\" width=\"30px\" alt=\"menu\" />\n                    </a>\n                    <nav className=\"p-navigation__nav\">\n                        <span className=\"u-off-screen\"><a href=\"#navigation\">Jump to site</a></span>\n                        <Navigation section={this.props.section} token={this.props.token} />\n                        <NavigationUser token={this.props.token} \n                            accounts={this.props.accounts} selectedAccount={this.props.selectedAccount}\n                            onAccountChange={this.props.onAccountChange} />\n                    </nav>\n                  </div>\n                </div>\n            </header>\n        )\n    }\n}\n\nexport default Header;\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport React, {Component} from 'react';\nimport api from '../models/api';\nimport {T} from './Utils';\n\n\nclass Footer extends Component {\n\n  constructor(props) {\n      super(props)\n      this.state = {version: ''};\n\n      this.getVersion();\n  }\n\n  getVersion() {\n    api.version().then(response => {\n        this.setState({version: response.data.version})\n    })\n  }\n\n  render() {\n    return (\n      <footer className=\"spacer\">\n        <div>\n          <p><small>{T('version')}: {this.state.version}</small></p>\n        </div>\n      </footer>\n    );\n  }\n}\n\nexport default Footer;\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nimport React, {Component} from 'react';\n\n\nclass AlertBox extends Component {\n    render() {\n        if (this.props.message) {\n            var c = 'p-notification--';\n            if (this.props.type) {\n                c = c + this.props.type;\n            } else {\n                c = c + 'negative';\n            }\n\n            return (\n                <div className={c}>\n                    <p className=\"p-notification__response\">{this.props.message}</p>\n                </div>\n            );\n        } else {\n            return <span />;\n        }\n    }\n}\n\nexport default AlertBox;\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nimport React, {Component} from 'react';\nimport api from '../models/api';\nimport AlertBox from './AlertBox';\nimport {T, isUserAdmin, isUserSuperuser} from './Utils';\n\nclass Accounts extends Component {\n    \n    constructor(props) {\n        super(props)\n        this.state = {\n            message: null,\n            accounts: [],\n        };\n\n        this.getAccounts();\n    }\n\n    getAccounts () {\n        api.accountsList().then(response => {\n            this.setState({accounts: response.data.accounts})\n        })\n    }\n\n    renderTable(items) {\n        \n        if (items.length > 0) {\n            return (\n            <div>\n                <table>\n                <thead>\n                    <tr>\n                    <th>{T('code')}</th><th>{T('name')}</th><th>{T('active')}</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {this.renderRows(items)}\n                </tbody>\n                </table>\n            </div>\n            );\n        } else {\n            return (\n            <p>{T('no-accounts')}</p>\n            );\n        }\n    }\n\n    renderRows(items) {\n        return items.map((l) => {\n          var isSuperuser = isUserSuperuser(this.props.token)\n          return (\n            <tr key={l.id}>\n                <td>{isSuperuser ? <a href={'/accounts/' + l.id}>{l.code}</a> : l.code}</td>\n                <td>{l.name}</td>\n                <td>{l.active ? <i className=\"fa fa-check\" /> :  <i className=\"fa fa-times\" />}</td>\n            </tr>\n          );\n        });\n    }\n\n    render () {\n\n        if (!isUserAdmin(this.props.token)) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n                </div>\n            )\n        }\n        var isSuperuser = isUserSuperuser(this.props.token)\n\n        return (\n            <div className=\"row\">\n                <section className=\"row\">\n                    <div>\n                        <h2>{T('accounts')}\n                            {isSuperuser ?\n                                <div className=\"u-float-right\">\n                                    <a href=\"/accounts/new\" className=\"p-button--brand\" title={T('new-account')}>\n                                        <i className=\"fa fa-plus\" aria-hidden=\"true\" />\n                                    </a>\n                                </div>\n                                : ''\n                            }\n                        </h2>\n                    </div>\n                    <div className=\"col-12\">\n                        <AlertBox message={this.state.message} />\n                    </div>\n                </section>\n\n                <section className=\"row\">\n                    {this.renderTable(this.state.accounts)}\n                </section>\n            </div>\n        )\n    }\n\n}\n\nexport default Accounts;\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nimport React, {Component} from 'react';\nimport api from '../models/api';\nimport AlertBox from './AlertBox';\nimport {T, isUserSuperuser, formatError} from './Utils';\n\nclass AccountEdit extends Component {\n    \n    constructor(props) {\n        super(props)\n        this.state = {\n            title: null,\n            error: null,\n            hideForm: false,\n            account: {active: true},\n        };\n    }\n\n    componentDidMount() {\n\n        if (this.props.id) {\n            this.setTitle('edit-account');\n            this.getAccount(this.props.id);\n        } else {\n            this.setTitle('new-account');\n        }\n    }\n\n    getAccount(id) {\n        api.accountsGet(id).then(response => {\n            this.setState({account: response.data.account});\n        })\n        .catch((e) => {\n            this.setState({error: formatError(e.response.data), hideForm: true});\n        })\n    }\n\n    setTitle(title) {\n        this.setState({title: T(title)});\n    }\n\n    handleChangeCode = (e) => {\n        var account = this.state.account;\n        account['code'] = e.target.value;\n        this.setState({account: account});\n    }\n\n    handleChangeName = (e) => {\n        var account = this.state.account;\n        account['name'] = e.target.value;\n        this.setState({account: account});\n    }\n\n    handleChangeActive = (e) => {\n        var account = this.state.account;\n        account['active'] = e.target.checked;\n        this.setState({account: account});\n    }\n\n    handleSaveClick = (e) => {\n        e.preventDefault();\n\n        if (this.props.id) {\n            api.accountsUpdate(this.props.id, this.state.account).then(response => {\n                window.location = '/accounts';\n            })\n            .catch(e => {\n                this.setState({error: formatError(e.response.data), hideForm: false});\n            })\n        } else {\n            api.accountsNew(this.state.account).then(response => {\n                window.location = '/accounts';\n            })\n            .catch(e => {\n                this.setState({error: formatError(e.response.data), hideForm: false});\n            })\n        }\n    }\n\n    render() {\n        if (!isUserSuperuser(this.props.token)) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n                </div>\n            )\n        }\n\n        if (this.state.hideForm) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={this.state.error} />\n                </div>\n            )\n        }\n\n        return (\n            <div className=\"row\">\n                <section className=\"row\">\n                    <h2>{this.state.title}</h2>\n\n                    <AlertBox message={this.state.error} />\n\n                    <form>\n                        <fieldset>\n                            <label htmlFor=\"code\">{T('code')}:\n                                <input type=\"text\" id=\"code\" placeholder={T('account-code-desc')}\n                                    value={this.state.account['code']} onChange={this.handleChangeCode} />\n                            </label>\n                            <label htmlFor=\"name\">{T('name')}:\n                                <input type=\"text\" id=\"name\" placeholder={T('account-name-desc')}\n                                    value={this.state.account.name} onChange={this.handleChangeName}/>\n                            </label>\n                            <label htmlFor=\"active\">{T('active')}\n                                <input type=\"checkbox\" id=\"active\" placeholder={T('account-active-desc')}\n                                    checked={this.state.account.active} onChange={this.handleChangeActive}/>\n                            </label>\n                        </fieldset>\n                    </form>\n\n                    <div>\n                        <a href='/accounts' className=\"p-button--neutral\">{T('cancel')}</a>\n                        &nbsp;\n                        <a href='/accounts' onClick={this.handleSaveClick} className=\"p-button--brand\">{T('save')}</a>\n                    </div>\n                </section>\n                <br />\n            </div>\n        )\n\n    }\n}\n\nexport default AccountEdit;\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nimport React, {Component} from 'react';\nimport {T} from './Utils';\n\nclass DialogBox extends Component {\n\n    render() {\n\n        if (this.props.message) {\n            return (\n                <div className=\"p-card warning\">\n                    <p>{this.props.message}</p>\n                    <div>\n                        <button onClick={this.props.handleCancelClick} className=\"p-button--neutral small\">\n                            {T('cancel')}\n                        </button>\n                        <button onClick={this.props.handleYesClick} className=\"p-button--brand small\">\n                            {T('ok')}\n                        </button>\n                    </div>\n                </div>\n            );\n        } else {\n            return <span />;\n        }\n    }\n}\n\nexport default DialogBox;\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport React, {Component} from 'react';\nimport api from '../models/api';\nimport AlertBox from './AlertBox';\nimport DialogBox from './DialogBox';\nimport {T, formatError, isUserAdmin, roleAsString} from './Utils';\n\nclass Users extends Component {\n    \n    constructor(props) {\n        super(props)\n        this.state = {\n            message: null,\n            users: [],\n            accounts: [],\n            confirmDelete: null,\n            showAccountsId: null,\n        };\n\n        this.getUsers();\n    }\n\n    getUsers () {\n        api.usersList().then(response => {\n            this.setState({users: response.data.users})\n        })\n    }\n\n    getAccountsForUser (username, userId) {\n        api.accountsForUsers(username).then(response => {\n            this.setState({accounts: response.data.accounts, showAccountsId: userId})\n        })\n    }\n\n    handleDelete = (e) => {\n        e.preventDefault();\n        this.setState({confirmDelete: parseInt(e.target.getAttribute('data-key'), 10)});\n    }\n\n    handleDeleteUser = (e) => {\n        e.preventDefault();\n        var users = this.state.users.filter((user) => {\n          return user.id === this.state.confirmDelete;\n        });\n        if (users.length === 0) {\n          return;\n        }\n    \n        api.deleteUser(users[0]).then(response => {\n            window.location = '/users';\n        })\n        .catch((e) => {\n            this.setState({error: formatError(e.response.data)});\n        })\n    }\n\n    handleDeleteUserCancel = (e) => {\n        e.preventDefault();\n        this.setState({confirmDelete: null});\n    }\n\n    handleClickAccount = (e) => {\n        e.preventDefault();\n        var accountId = e.target.getAttribute('data-account');\n        var userId = parseInt(e.target.getAttribute('data-user'), 10);\n        var username = e.target.getAttribute('data-username');\n\n        api.accountsUpdateForUser(userId, accountId).then(response => {\n            this.getAccountsForUser(username, userId)\n        })\n    }\n\n    showAccounts = (e) => {\n        e.preventDefault();\n\n        var id = parseInt(e.target.getAttribute('data-key'), 10);\n        var username = e.target.getAttribute('data-user');\n        if (this.state.showAccountsId === id) {\n            this.setState({showAccountsId: null});\n        } else {\n            this.getAccountsForUser(username, id)\n        }\n    }\n\n    renderTable(items) {\n\n        if (items.length > 0) {\n            return (\n            <div>\n                <table>\n                <thead>\n                    <tr>\n                        <th /><th>{T('username')}</th><th>{T('name')}</th><th>{T('email')}</th><th>{T('role')}</th><th>{T('accounts')}</th>\n                    </tr>\n                </thead>\n                    {this.renderRows(items)}\n                </table>\n            </div>\n            );\n        } else {\n            return (\n            <p>{T('no-users')}</p>\n            );\n        }\n    }\n\n    renderActions(user) {\n        if (user.id !== this.state.confirmDelete) {\n            return (\n                <div>\n                    <a href={'/users/'.concat(user.id)} className=\"p-button--brand small\" title={T('edit-user')}><i className=\"fa fa-edit\" /></a>\n                    &nbsp;\n                    <button onClick={this.handleDelete} data-key={user.id} className=\"p-button--neutral small\" title={T('delete-user')}>\n                        <i className=\"fa fa-trash\" data-key={user.id} /></button>\n                </div>\n            );\n        } else {\n            return (\n                <DialogBox message={T('confirm-user-delete')} handleYesClick={this.handleDeleteUser} handleCancelClick={this.handleDeleteUserCancel} />\n            );\n        }\n    }\n\n    renderRows(items) {\n        return items.map((l) => {\n          var c = \"\";\n          if (l.id === this.state.showAccountsId) {\n            c = 'borderless';\n          }\n          return (\n              <tbody>\n                <tr key={l.id} className={c}>\n                    <td>\n                    {this.renderActions(l)}\n                    </td>\n                    <td className=\"overflow\" title={l.username}>{l.username}</td>\n                    <td className=\"overflow\" title={l.name}>{l.name}</td>\n                    <td className=\"overflow\" title={l.email}>{l.email}</td>\n                    <td className=\"overflow\" title={roleAsString(l.role)}>{roleAsString(l.role)}</td>\n                    <td className=\"overflow\">\n                        <button className=\"p-button--neutral small\" title={T('view-accounts')} data-key={l.id} data-user={l.username} onClick={this.showAccounts}>\n                            <i className=\"fa fa-building\" aria-hidden=\"true\" data-key={l.id} data-user={l.username} />\n                        </button>\n                    </td>\n                </tr>\n                {this.renderAccounts(l)}\n              </tbody>\n          );\n        });\n    }\n    \n    renderAccounts(item) {\n        if (item.id !== this.state.showAccountsId) {\n            return\n        }\n\n        var style;\n\n        var accounts = this.state.accounts.map(acc => {\n            if (acc.selected) {\n                style = 'p-button--brand';\n            } else {\n                style = 'p-button--neutral';\n            }\n            return (\n                <button key={acc.code} data-account={acc.id} data-user={item.id} data-username={item.username} onClick={this.handleClickAccount} className={style}>\n                {acc.name}\n                </button>\n            )\n        })\n\n        return (\n            <tr>\n                <td colSpan=\"6\">Select accounts for {item.name}:<br /> {accounts}</td>\n            </tr>\n        )\n    }\n\n    render () {\n\n        if (!isUserAdmin(this.props.token)) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n                </div>\n            )\n        }\n\n        return (\n            <div className=\"row\">\n                <section className=\"row\">\n                    <div>\n                        <h2>{T('users')}\n                            <div className=\"u-float-right\">\n                                <a href=\"/users/new\" className=\"p-button--brand\" title={T('new-user')}>\n                                    <i className=\"fa fa-plus\" aria-hidden=\"true\" />\n                                </a>\n                            </div>\n                        </h2>\n                    </div>\n                    <div className=\"col-12\">\n                        <AlertBox message={this.state.message} />\n                    </div>\n                </section>\n\n                <section className=\"row\">\n                    {this.renderTable(this.state.users)}\n                </section>\n            </div>\n        )\n    }\n\n}\n\nexport default Users;\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport React, {Component} from 'react';\nimport api from '../models/api';\nimport AlertBox from './AlertBox';\nimport {T, formatError, isUserSuperuser} from './Utils';\n\nclass UserEdit extends Component {\n\n    constructor(props) {\n        super(props)\n        this.state = {\n            title: null,\n            user: {},\n            error: null,\n            hideForm: false,\n        }\n    }\n\n    componentDidMount() {\n        if (this.props.id) {\n            this.setTitle('edit-user');\n            this.getUser(this.props.id);\n        } else {\n            this.setTitle('new-user');\n        }\n    }\n\n    setTitle(title) {\n        this.setState({title: T(title)});\n    }\n\n    getUser(userId) {\n        api.usersGet(userId).then((response) => {\n            this.setState({\n                user: response.data.user, \n                hideForm: false,\n            });\n        })\n        .catch((e) => {\n            this.setState({error: formatError(e.response.data)});\n        })\n    }\n\n    handleChangeUsername = (e) => {\n        var user = this.state.user;\n        user.username = e.target.value;\n        this.setState({user: user});\n    }\n\n    handleChangeName = (e) => {\n        var user = this.state.user;\n        user.name = e.target.value;\n        this.setState({user: user});\n    }\n\n    handleChangeEmail = (e) => {\n        var user = this.state.user;\n        user.email = e.target.value;\n        this.setState({user: user});\n    }\n\n    handleChangeRole = (e) => {\n        var user = this.state.user;\n        user.role = parseInt(e.target.value, 10);\n        this.setState({user: user});\n    }\n\n    handleSaveClick = (e) => {\n        e.preventDefault();\n\n        if (this.props.id) {\n            // Update the existing user\n            api.usersUpdate(this.props.id, this.state.user).then(response => {\n                window.location = '/users';\n            })\n            .catch(e => {\n                this.setState({error: formatError(e.response.data), hideForm: false});\n            })\n        } else {\n            // Create a new user\n            api.usersNew(this.state.user).then(response => {\n                window.location = '/users';\n            })\n            .catch(e => {\n                this.setState({error: formatError(e.response.data), hideForm: false});\n            })\n        }\n    }\n\n    renderError() {\n        if (this.state.error) {\n            return (\n                <AlertBox message={this.state.error} />\n            );\n        }\n    }\n\n    render() {\n        if (!isUserSuperuser(this.props.token)) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n                </div>\n            )\n        }\n\n        if (this.state.hideForm) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={this.state.error} />\n                </div>\n            )\n        }\n\n        return (\n            <div className=\"row\">\n                <section className=\"row\">\n                      <h2>{this.state.title}</h2>\n\n                        <AlertBox message={this.state.error} />\n\n                        <form>\n                            <fieldset>\n                                <label htmlFor=\"username\">{T('username')}:\n                                    <input type=\"text\" id=\"username\" placeholder={T('user-username-desc')}\n                                        value={this.state.user.username} onChange={this.handleChangeUsername} />\n                                </label>\n                                <label htmlFor=\"name\">{T('name')}:\n                                    <input type=\"text\" id=\"name\" placeholder={T('user-name-desc')}\n                                        value={this.state.user.name} onChange={this.handleChangeName}/>\n                                </label>\n                                <label htmlFor=\"email\">{T('email')}:\n                                    <input type=\"text\" id=\"email\" placeholder={T('user-email-desc')}\n                                        value={this.state.user.email} onChange={this.handleChangeEmail}/>\n                                </label>\n                                <label htmlFor=\"role\">{T('role')}:\n                                    <select value={this.state.user.role} id=\"role\" onChange={this.handleChangeRole}>\n                                        <option />\n                                        <option key=\"standard\" value=\"100\">Standard</option>\n                                        <option key=\"admin\" value=\"200\">Admin</option>\n                                        <option key=\"superuser\" value=\"300\">Superuser</option>\n                                    </select>\n                                </label>\n                            </fieldset>\n                        </form>\n\n                        <div>\n                            <a href='/users' className=\"p-button--neutral\">{T('cancel')}</a>\n                            &nbsp;\n                            <a href='/users' onClick={this.handleSaveClick} className=\"p-button--brand\">{T('save')}</a>\n                        </div>\n                </section>\n                <br />\n            </div>\n        )\n    }\n}\n\nexport default UserEdit;\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport React from 'react'\n\nexport default function If({ cond, children }) {\n  if (!cond) return null\n  return (\n    Array.isArray(children)\n      ? ( <div>{children}</div> )\n      : children\n  )\n}\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport React, {Component} from 'react';\nimport moment from 'moment';\nimport AlertBox from './AlertBox';\nimport If from './If';\nimport {T} from './Utils';\n\nclass Device extends Component {\n\n    render () {\n        var d = this.props.client;\n        if (!d.info) {return <div>Loading...</div>};\n\n        return (\n            <div className=\"row\">\n                <h1 className=\"tight\">{d.device.accountCode} {d.device.name}</h1>\n                <h4 className=\"subtitle\">{d.device.serial}</h4>\n\n                <section className=\"row spacer\">\n                    <div className=\"col-12\">\n                        <AlertBox message={this.props.message} />\n                    </div>\n                </section>\n\n                <If cond={!this.props.message}>\n                    <section className=\"row spacer\">\n                        <div className=\"p-card--highlighted col-6\">\n                            <table className=\"p-card__content\">\n                                <tbody>\n                                    <tr>\n                                        <td>{T('last-update')}:</td><td>{moment(d.device.lastRefresh).format('llll')}</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{T('registered')}:</td><td>{moment(d.device.created).format('llll')}</td>\n                                    </tr>\n                                </tbody>\n                            </table>\n                        </div>\n                    </section>\n\n                    <section className=\"row spacer\">\n                        <div className=\"p-card\">\n                            <h3 className=\"p-card__title\">{T('system-info')}</h3>\n                            <table className=\"p-card__content\">\n                                <tbody>\n                                    <tr>\n                                        <td>{T('model')}:</td><td>{d.device.accountCode} {d.device.name}</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{T('serial-number')}:</td><td>{d.device.serial}</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{T('software-version')}:</td><td>{d.info.softwareversion}</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{T('firmware-version')}:</td><td>{d.info.firmwareversion}</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{T('current-time')}:</td><td>{d.info.currenttime}</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{T('utc-offset')}:</td><td>{d.info.utcoffset}</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{T('timezone')}:</td><td>{d.info.timezone}</td>\n                                    </tr>\n                                    <tr>\n                                        <td>{T('uptime')}:</td><td>{d.info.uptime}</td>\n                                    </tr>\n                                </tbody>\n                            </table>\n                        </div>\n                    </section>\n                </If>\n            </div>\n        )\n    }\n}\n\nexport default Device\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport React, {Component} from 'react';\nimport moment from 'moment';\nimport AlertBox from './AlertBox';\nimport {T} from './Utils';\n\n\nclass Register extends Component {\n\n    constructor(props) {\n        super(props)\n        this.state = {\n            message: null,\n        };\n    }\n\n    getAge(m) {\n        var start = moment(m);\n        var end = moment()\n        var dur = moment.duration(end.diff(start));\n        var d = dur.asMinutes()\n        if (d < 2) {\n            return <i className=\"fa fa-clock led-green\" title={start.format('llll')} />\n        } else if (d < 5) {\n            return <i className=\"fa fa-clock led-orange\" title={start.format('llll')} />\n        } else {\n            return <i className=\"fa fa-clock led-red\" title={start.format('llll')} />\n        }\n    }\n\n    renderTable(items) {\n        \n        if (!items) {\n            return\n        }\n        if (items.length > 0) {\n            return (\n            <div>\n                <table>\n                <thead>\n                    <tr>\n                        <th>{T('account')}</th><th>{T('model')}</th><th>{T('serial')}</th>\n                        <th className=\"xsmall\">{T('status')}</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {this.renderRows(items)}\n                </tbody>\n                </table>\n            </div>\n            );\n        } else {\n            return (\n            <p>{T('no-devices')}</p>\n            );\n        }\n    }\n\n    renderRows(items) {\n        return items.map((l) => {\n          return (\n            <tr key={l.registrationId}>\n                <td className=\"overflow\"><a href={'/devices/' + l.id+ '/info'}>{l.accountCode}</a></td>\n                <td className=\"overflow\"><a href={'/devices/' + l.id+ '/info'}>{l.name}</a></td>\n                <td className=\"overflow\"><a href={'/devices/' + l.id+ '/info'}>{l.serial}</a></td>\n                <td>\n                    {this.getAge(l.lastRefresh)}\n                </td>\n            </tr>\n          );\n        });\n    }\n\n    render () {\n        return (\n            <div className=\"row\">\n                <section className=\"row\">\n                    <h2>\n                        {T('register-devices')}\n                    </h2>\n                    <div className=\"col-12\">\n                        <AlertBox message={this.state.message} />\n                    </div>\n                </section>\n\n                <section className=\"row spacer\">\n                    {this.renderTable(this.props.devices)}\n                </section>\n            </div>\n        )\n    }\n}\n\nexport default Register;\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport React, {Component} from 'react';\nimport api from '../models/api';\nimport AlertBox from './AlertBox';\nimport {T, isUserAdmin, formatError} from './Utils';\n\n\nclass RegisterEdit extends Component {\n    \n    constructor(props) {\n        super(props)\n        this.state = {\n            title: null,\n            error: null,\n            hideForm: false,\n            device: {active: true},\n        };\n    }\n\n    componentDidMount() {\n        if (this.props.id) {\n            this.setTitle('edit-device');\n            this.getDevice(this.props.id);\n        } else {\n            this.setTitle('new-device');\n        }\n    }\n\n    getDevice(id) {\n        api.devicesGet(this.props.account.code, id).then(response => {\n            this.setState({device: response.data.device});\n        })\n        .catch((e) => {\n            this.setState({error: formatError(e.response.data), hideForm: true});\n        })\n    }\n\n    setTitle(title) {\n        this.setState({title: T(title)});\n    }\n\n    handleChangeName = (e) => {\n        var device = this.state.device;\n        device.name = e.target.value;\n        this.setState({device: device});\n    }\n\n    handleChangeActive = (e) => {\n        var device = this.state.device;\n        device.active = e.target.checked;\n        this.setState({device: device});\n    }\n\n    handleSaveClick = (e) => {\n        e.preventDefault();\n\n        if (this.props.id) {\n            // Update the existing device\n            api.devicesUpdate(this.props.account.code, this.state.device).then(response => {\n                window.location = '/devices';\n            })\n            .catch(e => {\n                this.setState({error: formatError(e.response.data), hideForm: false});\n            })\n        } else {\n            // Create a new device\n            api.devicesNew(this.props.account.code, this.state.device).then(response => {\n                window.location = '/devices';\n            })\n            .catch(e => {\n                this.setState({error: formatError(e.response.data), hideForm: false});\n            })\n        }\n    }\n\n    render () {\n\n        if (!isUserAdmin(this.props.token)) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n                </div>\n            )\n        }\n\n        if (this.state.hideForm) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={this.state.error} />\n                </div>\n            )\n        }\n\n        return (\n            <div className=\"row\">\n                <section className=\"row\">\n                    <h2>{this.state.title}</h2>\n\n                    <AlertBox message={this.state.error} />\n\n                    <form>\n                        <fieldset>\n                            <label htmlFor=\"name\">{T('name')}:\n                                <input type=\"text\" id=\"name\" placeholder={T('device-name-desc')}\n                                    value={this.state.device.name} onChange={this.handleChangeName}/>\n                            </label>\n                            <label htmlFor=\"active\">{T('active')}\n                                <input type=\"checkbox\" id=\"active\"\n                                    checked={this.state.device.active} onChange={this.handleChangeActive}/>\n                            </label>\n                        </fieldset>\n                    </form>\n\n                    <div>\n                        <a href='/devices' className=\"p-button--neutral\">{T('cancel')}</a>\n                        &nbsp;\n                        <a href='/devices' onClick={this.handleSaveClick} className=\"p-button--brand\">{T('save')}</a>\n                    </div>\n                </section>\n                <br />\n            </div>\n        )\n\n    }\n}\n\nexport default RegisterEdit;\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport React, { Component } from 'react'\n\nclass Pagination extends Component {\n\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      page: 1,\n      query: null,\n      maxRecords: props.pageSize | 5,\n    }\n  }\n\n  pageUp = () => {\n    var pages = this.calculatePages();\n    var page = this.state.page + 1;\n    if (page > pages) {\n        page = pages;\n    }\n    this.setState({page: page});\n    this.signalPageChange(page);\n  }\n\n  pageDown = () => {\n    var page = this.state.page - 1;\n    if (page <= 0) {\n        page = 1;\n    }\n    this.setState({page: page});\n    this.signalPageChange(page);\n  }\n\n  signalPageChange(page) {\n    // Signal the rows that the owner should display\n    var startRow = ((page - 1) * this.state.maxRecords);\n\n    this.props.pageChange(startRow, startRow + this.state.maxRecords);\n  }\n\n  calculatePages() {\n    // Use the filtered row count when we a query has been entered\n    var length = this.props.displayRows.length;\n\n    var pages = parseInt(length / this.state.maxRecords, 10);\n    if (length % this.state.maxRecords > 0) {\n        pages += 1;\n    }\n\n    return pages;\n  }\n\n  renderPaging() {\n    var pages = this.calculatePages();\n    if (pages > 1) {\n        return (\n            <div className=\"u-float--right spacer\">\n                <button className=\"p-button--neutral small\" href=\"\" onClick={this.pageDown}>&laquo;</button>\n                <span>&nbsp;{this.state.page} of {pages}&nbsp;</span>\n                <button className=\"p-button--neutral small\" href=\"\" onClick={this.pageUp}>&raquo;</button>\n            </div>\n        );\n    } else {\n        return <div className=\"u-float--right\" />;\n    }\n  }\n\n  render() {\n    return (\n        <div className=\"col-12\">\n            {this.renderPaging()}\n        </div>\n    );\n  }\n}\n\nexport default Pagination\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nimport React, {Component} from 'react';\nimport api from '../models/api';\nimport Pagination from './Pagination';\nimport {LoadingImage} from './Constants';\nimport {T} from './Utils';\nimport filesize from 'filesize'\n\nconst PAGELENGTH = 5;\n\nclass SnapDialogBox extends Component {\n\n    constructor(props) {\n        super(props)\n        this.state = {\n            snapName: '',\n            snaps: [],\n            loadingSearch: false,\n\n            page: 1,\n            startRow: 0,\n            endRow: PAGELENGTH,\n        };\n    }\n\n    searchStore() {\n        if (this.state.snapName.length===0) {\n            return\n        }\n        this.setState({loadingSearch: true})\n        api.storeSearch(this.state.snapName).then(response => {\n            if ((response.data._embedded) && (response.data._embedded['clickindex:package'])) {\n                this.setState({snaps: response.data._embedded['clickindex:package'], loadingSearch: false, message: null, messageType: null})\n            }\n        })\n    }\n\n    handleSearchChange = (e) => {\n        e.preventDefault()\n        this.setState({snapName: e.target.value})\n    }\n\n    handleKeyPress = (e) => {\n        if (e.key === 'Enter') {\n            this.handleSearchStore(e)\n        }\n    }\n\n    handleSearchStore = (e) => {\n        e.preventDefault()\n        this.searchStore()\n    }\n\n    handleInstall = (e) => {\n        e.preventDefault()\n        var snap = e.target.getAttribute('data-key')\n\n        this.props.handleInstallClick(snap);\n    }\n\n    handleRecordsForPage = (startRow, endRow) => {\n        this.setState({startRow: startRow, endRow: endRow});\n    }\n\n    renderSnaps(snaps) {\n        if (snaps.length > 0) {\n\n            return (\n                <div>\n                    <p>{snaps.length} snaps found</p>\n                    <table>\n                        <tbody>\n                        {snaps.slice(this.state.startRow, this.state.endRow).map(s => {\n                            return (\n                                <tr key={s.snap_id} title={s.description}>\n                                    <td className=\"small\">\n                                        <button data-key={s.package_name} className=\"p-button--neutral small\" title={T(\"install-on-device\")} onClick={this.handleInstall}>\n                                            <i data-key={s.package_name} className=\"fa fa-cloud-upload-alt\" aria-hidden=\"true\" />\n                                        </button>\n                                    </td>\n                                    <td className=\"overflow\">\n                                        <b>{s.package_name}</b> {s.version}\n                                    </td>\n                                    <td className=\"overflow\">\n                                        {s.developer_name} ({filesize(s.binary_filesize)})\n                                    </td>\n                                </tr>\n                            )\n                        })}\n                        </tbody>\n                    </table>\n                </div>\n            )\n        } else {\n            return <div>No snaps found.</div>\n        }\n    }\n\n    render() {\n        var snaps = this.state.snaps\n\n        if (this.props.message) {\n            return (\n                <div className=\"p-card col-4\">\n                    <h3 className=\"p-card__title\">{T('snap-store')}</h3>\n                    <p>\n                        {this.state.loadingSearch ? <img src={LoadingImage} alt={T('loading')} /> : ''}\n                        {this.props.message}\n                    </p>\n                    <p>\n                        <form className=\"p-search-box\">\n                          <input className=\"p-search-box__input\" type=\"search\" name=\"snapname\" onKeyPress={this.handleKeyPress} onChange={this.handleSearchChange} placeholder={T('search-store')} />\n                          <button type=\"reset\" className=\"p-search-box__reset\" alt=\"reset\"><i className=\"p-icon--close\" /></button>\n                          <button type=\"submit\" onClick={this.handleSearchStore} className=\"p-search-box__button\" alt=\"search\"><i className=\"p-icon--search\" /></button>\n                        </form>\n                    </p>\n\n                    <Pagination displayRows={snaps}\n                            pageSize={PAGELENGTH}\n                            pageChange={this.handleRecordsForPage} />\n\n                    {this.renderSnaps(snaps)}\n                    <div>\n                        <button onClick={this.props.handleCancelClick} className=\"p-button--brand\">\n                            {T('close')}\n                        </button>\n                    </div>\n                </div>\n            );\n        } else {\n            return <span />;\n        }\n    }\n}\n\nexport default SnapDialogBox;\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport React, {Component} from 'react';\nimport moment from 'moment';\nimport api from '../models/api';\nimport SnapDialogBox from './SnapDialogBox';\nimport If from './If';\nimport AlertBox from './AlertBox';\nimport {T} from './Utils';\n\nclass DeviceSnaps extends Component {\n\n    constructor(props) {\n        super(props)\n        this.state = {\n            message: null,\n            messageType: null,\n            showInstall: false,\n            snapName: '',\n            snapSettings: null,\n            settings: {},\n            hideForm: false,\n        };\n\n    }\n\n    findSnap(name) {\n        return this.props.snaps.filter( s => s.name===name)[0]\n    }\n\n    handleRefreshList = (e) => {\n        e.preventDefault()\n        window.location.reload()\n    }\n\n    handleInstall= (e) => {\n        e.preventDefault()\n        this.setState({showInstall: true})\n    }\n\n    handleSnapInstall = (snap) => {\n        api.snapsInstall(this.props.account.code, this.props.device, snap).then(response => {\n            this.setState({\n                message: 'Sent request to install snap: ' + snap,\n                messageType: 'information',\n            })\n        })\n    }\n\n    handleSnapOnChange= (e) => {\n        e.preventDefault();\n        this.setState({snapName: e.target.value});\n    }\n\n    handleRefresh = (e) => {\n        e.preventDefault()\n\n        var snap = e.target.getAttribute('data-key')\n        api.snapsUpdate(this.props.account.code, this.props.device, snap, 'refresh').then(response => {\n            this.setState({message: 'Sent request to refresh snap: ' + snap, messageType: 'information'});\n        })\n    }\n\n    handleToggle = (e) => {\n        e.preventDefault()\n\n        var snap = e.target.getAttribute('data-key')\n\n        // Check if we need to activate or deactivate the snap\n        var s = this.findSnap(snap)\n        var action = 'enable';\n        if (s.status === 'active') {\n            action = 'disable';\n        }\n\n        api.snapsUpdate(this.props.account.code, this.props.device, snap, action).then(response => {\n            this.setState({message: 'Sent request to enable/disable snap: ' + snap, messageType: 'information'});\n        })\n    }\n\n    handleRemove = (e) => {\n        e.preventDefault()\n        var snap = e.target.getAttribute('data-key')\n        api.snapsRemove(this.props.account.code, this.props.device, snap).then(response => {\n            this.setState({message: 'Sent request to remove snap: ' + snap, messageType: 'information'});\n        })\n    }\n\n    handleDialogCancel = (e) => {\n        e.preventDefault();\n        this.setState({showInstall: false});\n    }\n\n    handleShowSettings = (e) => {\n        e.preventDefault();\n        var snap = e.target.getAttribute('data-key');\n        if (this.state.snapSettings === snap) {\n            this.setState({snapSettings: null, settings: {}})\n        } else {\n            var s = this.findSnap(snap)\n            var settings = JSON.stringify( JSON.parse(s.config), null, 2) // pretty print\n            this.setState({snapSettings: snap, settings: settings})\n        }\n    }\n\n    handleSettingsChange = (e) => {\n        e.preventDefault();\n        this.setState({settings: e.target.value})\n    }\n\n    handleSettingsUpdate = (e) => {\n        e.preventDefault();\n        var snap = e.target.getAttribute('data-key');\n\n        api.snapsSettingsUpdate(this.props.account.code, this.props.device, snap, this.state.settings).then(response => {\n            this.setState({snapSettings: null, message: 'Sent request to update snap: ' + snap,\n                    messageType: 'information',\n            })\n        })\n    }\n\n    renderShowInstall() {\n        if (this.state.showInstall) {\n            return (\n                <SnapDialogBox message={T('confirm-snap-install')} \n                    handleTextChange={this.handleSnapOnChange}\n                    handleInstallClick={this.handleSnapInstall} handleCancelClick={this.handleDialogCancel} />\n            );\n        }\n    }\n\n    renderSettings(snap) {\n        if (snap.name !== this.state.snapSettings) {\n            return\n        }\n\n        return (\n            <tr>\n                <td colSpan=\"6\">\n                    <form>\n                        <fieldset>\n                            <label htmlFor={this.state.snapSettings}>\n                                Settings for {this.state.snapSettings}:\n                                <textarea className=\"col-12\" rows=\"4\" value={this.state.settings} data-key={this.state.snapSettings} onChange={this.handleSettingsChange} />\n                            </label>\n                        </fieldset>\n                        <button className=\"p-button--brand\" onClick={this.handleSettingsUpdate} data-key={snap.name}>{T('update')}</button>\n                    </form>\n                </td>\n            </tr>\n        )\n    }\n\n    render () {\n        var tableWidth = '';\n        var hide = '';\n        if (this.state.showInstall) {\n            tableWidth = ' col-8';\n            hide = 'hide';\n        }\n        var d = this.props.device;\n        if (!d.info) {return <div>Loading...</div>};\n\n        return (\n            <div className=\"row\">\n                <h1 className=\"tight\">{d.device.accountCode} {d.device.name}</h1>\n                <h4 className=\"subtitle\">{d.device.serial}</h4>\n\n                <section className=\"row spacer\">\n                    <div className=\"col-12\">\n                        <AlertBox message={this.state.message} type={this.state.messageType} />\n                    </div>\n                </section>\n\n                <If cond={!this.state.hideForm}>\n                    <section className=\"row spacer\">\n                        <div className={'p-card' + tableWidth}>\n                            <h3 className=\"p-card__title\">\n                                {T('installed-snaps')}\n\n                                <div className=\"u-float-right\">\n                                    <button onClick={this.handleRefreshList} className=\"p-button--brand\" title={T('refresh-snap-list')}>\n                                        <i className=\"fa fa-sync\" aria-hidden=\"true\" />\n                                    </button>\n                                    <button onClick={this.handleInstall} className=\"p-button--brand\" title={T('install-snap')}>\n                                        <i className=\"fa fa-plus\" aria-hidden=\"true\" />\n                                    </button>\n                                </div>\n                            </h3>\n                            <p title={T('last-update')}>{moment(d.device.lastRefresh).format('llll')}</p>\n\n                            <table className=\"p-card__content\">\n                                <thead>\n                                    <tr>\n                                        <th className={hide} />\n                                        <th className=\"small\">{T('snap')}</th><th className=\"xsmall\">{T('version')}</th><th>{T('summary')}</th><th className=\"xsmall\">{T('status')}</th>\n                                        <th className=\"xsmall\">{T('settings')}</th>\n                                    </tr>\n                                </thead>\n                                {this.props.snaps.map((s) => {\n                                    var c = '';\n                                    if (s.name === this.state.snapSettings) {\n                                        c = 'borderless'\n                                    }\n                                    return (\n                                        <tbody>\n                                        <tr key={s.name} className={c}>\n                                            <td className={hide}>\n                                                <button onClick={this.handleRefresh}  className=\"small u-float\" title={T(\"refresh\")} data-key={s.name}>\n                                                    <i className=\"fa fa-sync\" aria-hidden=\"true\" data-key={s.name} />\n                                                </button>\n                                                <button onClick={this.handleToggle}  className=\"small\" title={T(\"toggle-status\")} data-key={s.name}>\n                                                    <i className=\"fa fa-plug\" aria-hidden=\"true\" data-key={s.name} />\n                                                </button>\n                                                <button onClick={this.handleRemove} className=\"small\" title={T(\"remove\")} data-key={s.name}>\n                                                    <i className=\"fa fa-times\" aria-hidden=\"true\" data-key={s.name} />\n                                                </button>\n                                            </td>\n                                            <td title={s.description}>{s.name}</td>\n                                            <td>{s.version}</td>\n                                            <td>{s.summary}</td>\n                                            <td>{s.status}</td>\n                                            <td>\n                                                <button className=\"p-button--neutral small\" title={T('view-settings')} data-key={s.name} onClick={this.handleShowSettings}>\n                                                    <i className=\"fa fa-sliders-h\" aria-hidden=\"true\" data-key={s.name} />\n                                                </button>\n                                            </td>\n                                        </tr>\n                                        {this.renderSettings(s)}\n                                        </tbody>\n                                    )\n                                })}\n                            </table>\n\n                        </div>\n                        {this.renderShowInstall()}\n                    </section>\n                </If>\n            </div>\n        );\n    }\n}\n\nexport default DeviceSnaps","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nimport React, {Component} from 'react';\nimport AlertBox from './AlertBox';\nimport {T} from './Utils';\n\nclass Groups extends Component {\n\n    renderRows(items) {\n        return items.map((l) => {\n          console.log(l)\n          return (\n            <tr key={l.id}>\n                <td className=\"overflow\">\n                    <button>{l.name}</button>\n                </td>\n            </tr>\n          );\n        });\n    }\n\n\n    renderTable(items) {\n        \n        if (!items) {\n            return\n        }\n        if (items.length > 0) {\n            return (\n            <div className=\"col-3\">\n                <table>\n                <thead>\n                    <tr>\n                        <th>{T('name')}</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {this.renderRows(items)}\n                </tbody>\n                </table>\n            </div>\n            );\n        } else {\n            return (\n            <p>{T('no-groups')}</p>\n            );\n        }\n    }\n\n    render () {\n        return (\n            <div className=\"row\">\n                <section className=\"row\">\n                    <h2>{T('groups')}</h2>\n                    <div className=\"col-12\">\n                        <AlertBox message={this.props.message} />\n                    </div>\n                </section>\n\n                <section className=\"row spacer\">\n                    {this.renderTable(this.props.groups)}\n                </section>\n            </div>\n        )\n    }\n}\n\nexport default Groups\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n\nimport React, { Component } from 'react';\nimport {T, isLoggedIn} from './Utils'\nimport AlertBox from './AlertBox'\n\n\nclass Index extends Component {\n\n  constructor(props) {\n\n    super(props)\n    this.state = {\n      token: props.token || {},\n    }\n  }\n\n  renderUser() {\n    if (isLoggedIn(this.props.token)) {\n      return <div />\n    } else {\n      return (\n        <div>\n          <a href=\"/login\" className=\"p-button--brand\">{T('login')}</a>\n        </div>\n      )\n    }\n  }\n\n  renderError() {\n    if (this.props.error) {\n      return (\n        <AlertBox message={T('user-not-found')} />\n      )\n    }\n  }\n\n  render() {\n    return (\n        <div className=\"row\">\n\n\n          <section className=\"row\">\n            <h2>{T('title')}</h2>\n            <h3>{this.props.account.name}</h3>\n            {this.renderError()}\n            <div>\n              <div className=\"p-card\">\n                {T('site-description')}\n              </div>\n            </div>\n          </section>\n\n          <section className=\"row spacer\">\n            {this.renderUser()}\n          </section>\n        </div>\n    );\n  }\n}\n\nexport default Index;","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport React, { Component } from 'react';\nimport Header from './components/Header';\nimport Footer from './components/Footer';\nimport Navigation from './components/Navigation';\nimport AlertBox from './components/AlertBox';\nimport Accounts from './components/Accounts';\nimport AccountEdit from './components/AccountEdit';\nimport Users from './components/Users';\nimport UserEdit from './components/UserEdit';\nimport Device from './components/Device';\nimport Register from './components/Register';\nimport RegisterEdit from './components/RegisterEdit';\nimport DeviceSnaps from './components/DeviceSnaps';\nimport Groups from './components/Groups';\nimport If from './components/If';\nimport Index from './components/Index';\nimport api from './models/api';\nimport {T, isLoggedIn, parseRoute, sectionNavLinks, getAccount, saveAccount, formatError} from './components/Utils'\nimport './sass/App.css'\n\nimport createHistory from 'history/createBrowserHistory'\nconst history = createHistory()\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      location: history.location,\n      token: props.token || {},\n      accounts: [],\n      selectedAccount: getAccount() || {},\n      devices: [],\n      groups: [],\n      clients: [],\n      client: {},\n      clientObject: {},\n      snaps: [],\n    }\n\n    history.listen(this.handleNavigation.bind(this))\n    this.getAccounts()\n  }\n\n  handleNavigation(location) {\n    this.setState({ location: location })\n    window.scrollTo(0, 0)\n  }\n\n  getAccounts() {\n    if (isLoggedIn(this.props.token)) {\n        api.accountsList().then(response => {\n            var selectedAccount = this.state.selectedAccount;\n\n            // Reset selected if we're not filtering accounts\n            if (!this.props.token.accountFilter) {\n              selectedAccount = {code: 'all'}\n            }\n\n            if ((!this.state.selectedAccount.code) && (!getAccount().code) && (this.props.token.accountFilter)) {\n              // Set to the first in the account list\n              if (response.data.accounts.length > 0) {\n                selectedAccount = response.data.accounts[0]\n                saveAccount(selectedAccount)\n              }\n            }\n\n            this.setState({accounts: response.data.accounts, selectedAccount: selectedAccount})\n            this.updateDataForRoute(selectedAccount, false)\n        })\n    }\n  }\n\n  getDevices(code) {\n    api.devicesList(code).then(response => {\n        this.setState({devices: response.data.devices})\n    })\n  }\n\n  getClient (code, endpoint) {\n    api.clientsDetail(code, endpoint).then(response => {\n        this.setState({client: response.data})\n    }).catch(e => {\n        this.setState({message: formatError(e.response.data), client: {}});\n    })\n  }\n\n  getGroups (code) {\n    api.groupsList(code).then(response => {\n        this.setState({groups: response.data.groups})\n    }).catch(e => {\n        this.setState({message: formatError(e.response.data), clients: []});\n    })\n  }\n\n  getSnaps(code, endpoint) {\n    api.snapsList(code, endpoint).then(response => {\n        this.setState({snaps: response.data.snaps})\n    })\n    .catch(e => {\n        this.setState({message: formatError(e.response), snaps: []});\n    })\n  }\n\n  // Get the data that's conditional on the route\n  updateDataForRoute(selectedAccount, accountChanged) {\n      const r = parseRoute()\n\n      // Devices and registrations are unique for an account. So changing account may need to trigger a page change\n      if (accountChanged) {\n        // If we are on a clients subsection and the account is changed, navigated to the clients list\n        if ((r.section==='clients') && (r.sectionId)) {\n          window.location = '/clients'\n          return\n        }\n      }\n\n      if(r.section==='devices') {this.getDevices(selectedAccount.code)}\n      if((r.section==='devices') && (r.sectionId)) {this.getClient(selectedAccount.code, r.sectionId)}\n      if((r.section==='devices') && (r.sectionId) && (r.subsection==='snaps')) {this.getSnaps(selectedAccount.code, r.sectionId)}\n      if(r.section==='groups') {this.getGroups(selectedAccount.code)}\n  }\n\n  handleAccountChange = (account) => {\n    saveAccount(account)\n    this.setState({selectedAccount: account})\n\n    this.updateDataForRoute(account, true)\n  }\n\n  renderAccounts(sectionId, subsection) {\n    \n    if (!sectionId) {\n      return <Accounts token={this.props.token} />\n    }\n\n    switch(sectionId) {\n      case 'new':\n        return <AccountEdit token={this.props.token} />\n      default:\n        return <AccountEdit token={this.props.token} id={sectionId} />\n    }\n  }\n\n  renderUsers(sectionId, subsection) {\n\n    if (!sectionId) {\n      return <Users token={this.props.token} />\n    }\n\n    switch(sectionId) {\n      case 'new':\n        return <UserEdit token={this.props.token} />\n      default:\n        return <UserEdit token={this.props.token} id={sectionId} />\n    }\n  }\n\n  renderDevices(sectionId, subsection) {\n\n    if (!sectionId) {\n      return <Register token={this.props.token} devices={this.state.devices} account={this.state.selectedAccount} />\n    }\n\n    switch(subsection) {\n      case 'snaps':\n        return <DeviceSnaps token={this.props.token} endpoint={sectionId} account={this.state.selectedAccount}\n                  device={this.state.client} snaps={this.state.snaps} />\n      default:\n        return <Device token={this.props.token} endpoint={sectionId} message={this.state.message}\n                  client={this.state.client} clientObject={this.state.clientObject} account={this.state.selectedAccount} />\n    }\n  }\n\n  renderRegister(sectionId, subsection) {\n\n    if (!sectionId) {\n        return <Register token={this.props.token} devices={this.state.devices} account={this.state.selectedAccount} />\n    }\n\n    switch(sectionId) {\n      case 'new':\n        return <RegisterEdit token={this.props.token} account={this.state.selectedAccount} />\n      default:\n        return <RegisterEdit token={this.props.token} account={this.state.selectedAccount} id={sectionId} />\n    }\n  }\n\n  renderGroups(sectionId, subsection) {\n\n    if (!sectionId) {\n        return <Groups token={this.props.token} groups={this.state.groups} account={this.state.selectedAccount} />\n    }\n\n    // switch(sectionId) {\n    //   case 'new':\n    //     return <RegisterEdit token={this.props.token} account={this.state.selectedAccount} />\n    //   default:\n    //     return <RegisterEdit token={this.props.token} account={this.state.selectedAccount} id={sectionId} />\n    // }\n  }\n\n  renderSubnav(currentSection, sectionId, subsection) {\n    var l = sectionNavLinks(currentSection, sectionId);\n    if (l) {\n      return (\n        <div className=\"subnav\">\n          <nav className=\"p-navigation__nav p-navigation--light\" role=\"menubar\">\n            <Navigation links={l} section={currentSection} sectionId={sectionId} subsection={subsection} token={this.props.token} />\n          </nav>\n        </div>\n      );\n    } else {\n      return <span />\n    }\n  }\n\n  render() {\n\n    const r = parseRoute()\n    console.log(r)\n    console.log('---account', this.state.selectedAccount)\n\n    return (\n      <div className=\"App\">\n        <Header token={this.props.token} section={r.section}\n          accounts={this.state.accounts} selectedAccount={this.state.selectedAccount}\n          onAccountChange={this.handleAccountChange} />\n\n        <section className=\"p-strip--image is-shallow snapcraft-banner-background\">\n          <div className=\"row\">\n            \n          </div>\n        </section>\n\n        <If cond={isLoggedIn(this.props.token)}>\n          {this.renderSubnav(r.section, r.sectionId, r.subsection)}\n        </If>\n\n        <If cond={isLoggedIn(this.props.token)}>\n          <div className=\"page-content\">\n            {r.section===''? <Index token={this.props.token} account={this.state.selectedAccount} /> : ''}\n            {r.section==='notfound'? <Index token={this.props.token} error /> : ''}\n    \n            {r.section==='devices'? this.renderDevices(r.sectionId, r.subsection) : ''}\n            {r.section==='register'? this.renderRegister(r.sectionId, r.subsection) : ''}\n            {r.section==='groups'? this.renderGroups(r.sectionId, r.subsection) : ''}\n            {r.section==='accounts'? this.renderAccounts(r.sectionId, r.subsection) : ''}\n            {r.section==='users'? this.renderUsers(r.sectionId, r.subsection) : ''}\n          </div>\n        </If>\n        \n        <If cond={!isLoggedIn(this.props.token)}>\n          <div className=\"page-content\">\n              <div className=\"row\">\n                <AlertBox message={T('error-no-auth')} />\n                <a href=\"/login\" className=\"p-button--brand\">{T('login')}</a>\n              </div>\n          </div>\n        </If>\n\n        <Footer />\n\n      </div>\n    );\n  }\n}\n\n\nexport default App;\n","/*\n * This file is part of the IoT Management Service\n * Copyright 2019 Canonical Ltd.\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU Affero General Public License version 3, as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranties of MERCHANTABILITY,\n * SATISFACTORY QUALITY, or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport {getAuthToken}      from './components/Utils'\n\ngetAuthToken( (token) => {\n    ReactDOM.render(<App token={token} />, document.getElementById('root'));\n})\n//registerServiceWorker();\n"],"sourceRoot":""}